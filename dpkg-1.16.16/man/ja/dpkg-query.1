.\" dpkg manual page - dpkg-query(1)
.\"
.\" Copyright 息 2001 Wichert Akkerman <wakkerma@debian.org>
.\" Copyright 息 2006-2007 Frank Lichtenheld <djpig@debian.org>
.\" Copyright 息 2006-2012 Guillem Jover <guillem@debian.org>
.\" Copyright 息 2008-2011 Rapha谷l Hertzog <hertzog@debian.org>
.\"
.\" This is free software; you can redistribute it and/or modify
.\" it under the terms of the GNU General Public License as published by
.\" the Free Software Foundation; either version 2 of the License, or
.\" (at your option) any later version.
.\"
.\" This is distributed in the hope that it will be useful,
.\" but WITHOUT ANY WARRANTY; without even the implied warranty of
.\" MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
.\" GNU General Public License for more details.
.\"
.\" You should have received a copy of the GNU General Public License
.\" along with this program.  If not, see <http://www.gnu.org/licenses/>.
.
.\"*******************************************************************
.\"
.\" This file was generated with po4a. Translate the source file.
.\"
.\"*******************************************************************
.TH dpkg\-query 1 2012\-04\-03 "Debian Project" "dpkg suite"
.SH 名前
dpkg\-query \- dpkg データベースクエリツール
.
.SH 書式
\fBdpkg\-query\fP [\fIoption\fP...] \fIcommand\fP
.
.SH 説明
\fBdpkg\-query\fP は、\fBdpkg\fP データベースに格納されたパッケージの情報を表示するツールである。
.
.SH コマンド
.TP 
\fB\-l\fP, \fB\-\-list\fP [\fIpackage\-name\-pattern\fP...]
指定したパターンにマッチする名前のパッケージを表示する。 \fIpackage\-name\-pattern\fP
が指定されなかった場合は、not\-installed とマークされているもの (完全削除されているパッケージなど)
を除き、\fI/var/lib/dpkg/status\fP にある、すべてのパッケージを表示する。\fIpackage\-name\-pattern\fP
には、標準的なシェルのワイルドカード文字を使用することができる。ただし、シェルにファイル名の展開をさせないように、\fIpackage\-name\-pattern\fP
をクオートする必要があることに注意。例えば次のコマンドは、\*(lqlibc6\*(rq で始まる名前のすべてのパッケージを表示する:

.nf
  \fBdpkg\-query \-l \(aqlibc6*\(aq\fP
.fi

出力の先頭から 3 つのカラムは、順に期待される動作 (desired action)、パッケージの状況、エラー状態を示す。

期待される動作
.nf
  u = Unknown
  i = Install
  h = Hold
  r = Remove
  p = Purge
.fi

パッケージの状況:
.nf
  n = Not\-installed
  c = Config\-files
  H = Half\-installed
  U = Unpacked
  F = Half\-configured
  W = Triggers\-awaiting
  t = Triggers\-pending
  i = Installed
.fi

エラーフラグ:
.nf
  <empty> = (none)
  R = 要再インストール
.fi

大文字はエラーを示すものであり、パッケージに致命的な問題が発生していることを示す。上記の状態についての詳細は \fBdpkg\fP(1) を参照のこと。

この出力形式は変更できないが、端末の横幅に合わせて自動的に調整される。これは人間が目視することを想定したものであり、コンピュータに適した形式ではない。出力形式の設定方法については、\fB\-W\fP
(\fB\-\-show\fP) および \fB\-\-showformat\fP を参照のこと。
.TP 
\fB\-W\fP, \fB\-\-show\fP [\fIpackage\-name\-pattern\fP...]
\fB\-\-list\fP オプションと同様に、指定したパターンにマッチするすべてのパッケージを表示する。このオプションの出力は、
\fB\-\-showformat\fP
オプションによってカスタマイズすることができる。デフォルトの出力形式は、マッチしたパッケージごとに、(\fIMulti\-Arch\fP が \fBsame\fP
のパッケージ用のアーキテクチャ修飾子によって拡張された) パッケージ名とバージョンがタブで区切られた 1 行で表示される。
.TP 
\fB\-s\fP, \fB\-\-status\fP \fIpackage\-name\fP...
指定したパッケージの状況を表示する。実際は、インストールされたパッケージの状況データベースの内容が表示される。\fIpackage\-name\fP
が複数指定された場合、各パッケージは引数のリストで指定された順に、パッケージ間を空行で区切って表示される。
.TP 
\fB\-L\fP, \fB\-\-listfiles\fP \fIpackage\-name\fP...
\fIpackage\-name\fP がインストールしたファイルを一覧する。\fIpackage\-name\fP
が複数指定された場合、各パッケージは引数のリストで指定された順に、パッケージ間を空行で区切って表示される。パッケージ付属のインストールスクリプトによって作成されたファイルは含まれないことに注意。
.TP 
\fB\-\-control\-list\fP \fIpackage\-name\fP
\fIpackage\-name\fP がシステムにインストールした制御ファイルを一覧する。これは、\fB\-\-control\-show\fP
の引数として用いることができる。
.TP 
\fB\-\-control\-show\fP \fIpackage\-name\fP \fIcontrol\-file\fP
\fIpackage\-name\fP がシステムにインストールした \fIcontrol\-file\fP を標準出力に出力する。
.TP 
\fB\-c\fP, \fB\-\-control\-path\fP \fIpackage\-name\fP [\fIcontrol\-file\fP]
\fIpackage\-name\fP がシステムにインストールした制御ファイルのパスを表示する。\fIcontrol\-file\fP
が指定された場合は、該当の制御ファイルが存在している場合に限り、その制御ファイルのパスだけを表示する。\fB警告\fP:
このコマンドは廃止予定である。\fB\-\-control\-list\fP や \fB\-\-control\-show\fP の使用に切り替えてほしい。
.TP 
\fB\-S\fP, \fB\-\-search\fP \fIfilename\-search\-pattern\fP...
指定したパターンにマッチするファイルをインストールしたパッケージを検索する。パターンには、標準的なシェルのすべてのワイルドカード文字を使用することができる。このコマンドでは、メンテナスクリプトで作成された追加ファイルや、
alternative は検索することができない。
.TP 
\fB\-p\fP, \fB\-\-print\-avail\fP \fIpackage\-name\fP...
\fI/var/lib/dpkg/available\fP にある \fIpackage\-name\fP の詳細を表示する。\fIpackage\-name\fP
が複数指定された場合、各 \fIavailable\fP のエントリは、引数のリストで指定された順に、エントリ間を空行で区切って表示される。

\fIavailable\fP ファイルには、\fBdselect\fP を用いた際の更新情報しか保持されていないため、APT
ベースのフロントエンドを使っているユーザは、\fBapt\-cache show\fP \fIpackage\-name\fP を代わりに使用すべきである。
.TP 
\fB\-?\fP, \fB\-\-help\fP
利用方法を表示して終了する。
.TP 
\fB\-\-version\fP
バージョン情報を表示して終了する。
.
.SH オプション
.TP 
\fB\-\-admindir=\fP\fIdir\fP
\fBdpkg\fP データベースの位置を変更する。デフォルトの位置は \fI/var/lib/dpkg\fP である。
.TP 
\fB\-\-load\-avail\fP
\fB\-\-show\fP および \fB\-\-list\fP
コマンドを用いた際に利用可能なファイルもロードする。これらのコマンドはデフォルトではステータスファイルのみを検索対象とする。
.TP 
\fB\-f\fP, \fB\-\-showformat=\fP\fIformat\fP
このオプションは、\fB\-\-show\fP の出力の書式を指定するものである。書式は、一覧表示される各パッケージの出力を制御する文字列である。

フォーマット文字列中の \(lq\fB\e\fP\(rq はエスケープ文字である:

.nf
    \fB\en\fP  改行
    \fB\er\fP  復帰 (キャリッジリターン)
    \fB\et\fP  タブ
.fi

任意の文字の前に \(lq\fB\e\fP\(rq を配置することで、これに続く文字の特殊な意味を抑制できる。これは \(lq\fB\e\fP\(rq や
\(lq\fB$\fP\(rq に有用である。

パッケージ情報には、\(lq\fB${\fP\fIfield\fP[\fB;\fP\fIwidth\fP]\fB}\fP\(rq
という構文で、パッケージフィールドを参照する変数を含めることができる。各フィールドは右寄せで表示されるが、width
に負の値を指定すると左寄せになる。以下の \fIfield\fP が認識されるが、これらはステータスファイルに存在している必要はない
(内部フィールドやバイナリパッケージに格納されたフィールドの形で最終的に存在していればよい)。

.nf
    \fBArchitecture\fP
    \fBBugs\fP
    \fBConffiles\fP (内部フィールド)
    \fBConfig\-Version\fP (内部フィールド)
    \fBConflicts\fP
    \fBBreaks\fP
    \fBDepends\fP
    \fBDescription\fP
    \fBEnhances\fP
    \fBEssential\fP
    \fBFilename\fP (内部フィールド, フロントエンド関連)
    \fBHomepage\fP
    \fBInstalled\-Size\fP
    \fBMD5sum\fP (内部フィールド, フロントエンド関連)
    \fBMSDOS\-Filename\fP (内部フィールド, フロントエンド関連)
    \fBMaintainer\fP
    \fBOrigin\fP
    \fBPackage\fP
    \fBPre\-Depends\fP
    \fBPriority\fP
    \fBProvides\fP
    \fBRecommends\fP
    \fBReplaces\fP
    \fBRevision\fP (obsolete)
    \fBSection\fP
    \fBSize\fP (内部フィールド, フロントエンド関連)
    \fBSource\fP
    \fBStatus\fP (内部フィールド)
    \fBSuggests\fP
    \fBTag\fP (通常 .deb パッケージではなく、リポジトリの Packages ファイルに存在する)
    \fBTriggers\-Awaited\fP (内部フィールド)
    \fBTriggers\-Pending\fP (内部フィールド)
    \fBVersion\fP
.fi

以下は \fBdpkg\-query\fP が別のフィールドの値から生成した仮想的なフィールドである
(これらのフィールド名は、制御ファイルにおける適切な命名規則に従っていない点に留意)。

.nf
    \fBbinary:Package\fP
    \fBbinary:Summary\fP
    \fBdb:Status\-Abbrev\fP
    \fBsource:Package\fP
    \fBsource:Version\fP
.fi

デフォルトのフォーマット文字列は  \(lq\fB${binary:Package}\et${Version}\en\fP\(rq
である。実際には、ステータスファイルに含まれる他のすべてのフィールド (ユーザ定義フィールド)
も指定することができ、これらはそのまま表示される。変換やエラーチェックは行われない。\fBbinary:Package\fP は、パッケージの
\fIMulti\-Arch\fP フィールドが \fBsame\fP
となっているため、名前だけでは曖昧になってしまうパッケージについて、パッケージ名をアーキテクチャ修飾子 ("libc6:amd64" のような)
付きで表示する特殊なフィールドである。dpkg のメンテナとインストールされているバージョンを取得するには、以下を実行する:

.nf
  \fBdpkg\-query \-W \-f=\(aq${binary:Package} ${Version}\et${Maintainer}\en\(aq dpkg\fP
.fi
.
.SH 終了ステータス
.TP 
\fB0\fP
リクエストされたクエリが正しく実行された。
.TP 
\fB1\fP
コマンドラインの解析中もしくはクエリの実行中に問題が発生した。これには(\-\-control\-path を除き)
ファイルやパッケージが存在しなかった場合も含まれる。
.
.SH 環境変数
.TP 
\fBDPKG_ADMINDIR\fP
\fB\-\-admindir\fP オプションが設定されておらず、この変数が設定されている場合、この変数の値が dpkg データディレクトリとして用いられる。
.TP 
\fBCOLUMNS\fP
この設定により、\fB\-\-list\fP オプションによる出力の横幅が設定される。
.
.SH 関連項目
\fBdpkg\fP(1).

.SH 翻訳者
高橋 基信 <monyo@monyo.com>.
喜瀬 浩 <kise@fuyuneko.jp>.
関戸 幸一 <sekido@mbox.kyoto-inet.or.jp>.
鍋谷 栄展 <nabe@debian.or.jp>.
倉澤 望 <nabetaro@debian.or.jp>.
石川 睦 <ishikawa@linux.or.jp>.
鵜飼 文敏 <ukai@debian.or.jp>.
中野 武雄 <nakano@apm.seikei.ac.jp>.
.SH 翻訳校正
Debian JP Documentation ML <debian-doc@debian.or.jp>.
