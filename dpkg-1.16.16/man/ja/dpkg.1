.\" dpkg manual page - dpkg(1)
.\"
.\" Copyright 息 1996 Juho Vuori <javuori@cc.helsinki.fi>
.\" Copyright 息 1999 Jim Van Zandt <jrv@vanzandt.mv.com>
.\" Copyright 息 1999-2003 Wichert Akkerman <wakkerma@debian.org>
.\" Copyright 息 2000-2003 Adam Heath <doogie@debian.org>
.\" Copyright 息 2002 Josip Rodin
.\" Copyright 息 2004-2005 Scott James Remnant <keybuk@debian.org>
.\" Copyright 息 2006-2012 Guillem Jover <guillem@debian.org>
.\" Copyright 息 2007-2008 Ian Jackson <ian@davenant.greenend.org.uk>
.\" Copyright 息 2008-2011 Rapha谷l Hertzog <hertzog@debian.org>
.\"
.\" This is free software; you can redistribute it and/or modify
.\" it under the terms of the GNU General Public License as published by
.\" the Free Software Foundation; either version 2 of the License, or
.\" (at your option) any later version.
.\"
.\" This is distributed in the hope that it will be useful,
.\" but WITHOUT ANY WARRANTY; without even the implied warranty of
.\" MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
.\" GNU General Public License for more details.
.\"
.\" You should have received a copy of the GNU General Public License
.\" along with this program.  If not, see <http://www.gnu.org/licenses/>.
.
.\"*******************************************************************
.\"
.\" This file was generated with po4a. Translate the source file.
.\"
.\"*******************************************************************
.TH dpkg 1 2013\-07\-28 "Debian Project" "dpkg suite"
.SH 名前
dpkg \- Debian パッケージマネージャ
.
.SH 書式
\fBdpkg\fP [\fIoption\fP...] \fIaction\fP
.
.SH 警告
このマニュアルは、\fBdpkg\fP のコマンドラインオプションやパッケージ状態について、\fBdpkg \-\-help\fP
よりも、さらに詳細に理解したいユーザを対象としている。

\fBdpkg\fP
がパッケージをどのようにインストールするかを理解したいというパッケージのメンテナを対象としたものではない。特に、パッケージのインストールや削除の際の
\fBdpkg\fP の挙動に関する説明が不足している。
.
.SH 説明
\fBdpkg\fP は、Debian パッケージのインストール、ビルド、削除、管理を行うためのツールである。\fBdpkg\fP
の代表的なフロントエンドであり、利便性の高いツールが\fBaptitude\fP(1) である。dpkg 自体は、1 つのアクションと 0
個以上のオプションからなるコマンドラインパラメータによって制御される。アクションにより \fBdpkg\fP
の動作が指定され、オプションにより、そのアクションに関する挙動が制御される。

\fBdpkg\fP は \fBdpkg\-deb\fP(1) および \fBdpkg\-query\fP(1)
のフロントエンドとして用いることもできる。サポートされているアクションの一覧は、アクションセクションで後ほど説明する。これらのアクションが指示された場合、\fBdpkg\fP
は、アクションに対して指定されたパラメータを用いて \fBdpkg\-deb\fP もしくは \fBdpkg\-query\fP
を呼び出すが、現在のところオプションについては引き渡されない。バックエンドに対してこうしたオプションを指定したい場合は、直接呼び出す必要がある。
.
.SH パッケージに関する情報
\fBdpkg\fP は利用可能なパッケージに関して、いくばくかの有用な情報を管理している。情報は、\fBステータス\fP、\fBパッケージ選択状態\fP、\fBフラグ\fPの
3 つに分類でき、主に\fBdselect\fP によって変更されることが想定されている。
.SS パッケージのステータス
.TP 
\fBnot\-installed\fP
パッケージはシステムにインストールされていない。
.TP 
\fBconfig\-files\fP
パッケージの設定ファイルだけがシステムに存在している。
.TP 
\fBhalf\-installed\fP
パッケージのインストールは開始しているが、何らかの理由で完了していない。
.TP 
\fBunpacked\fP
パッケージは展開されたが、まだ設定されていない。
.TP 
\fBhalf\-configured\fP
パッケージは展開されて設定も開始しているが、何らかの理由によって完了していない。
.TP 
\fBtriggers\-awaited\fP
パッケージは別のパッケージによるトリガ処理を待機している。
.TP 
\fBtriggers\-pending\fP
パッケージはトリガされている。
.TP 
\fBinstalled\fP
パッケージの展開と設定が完了している。
.SS パッケージ選択状態
.TP 
\fBinstall\fP
パッケージはインストールするように選択されている。
.TP 
\fBhold\fP
\fBhold\fP 状態にあるパッケージは、\fB\-\-force\-hold\fP オプションで強制しない限り、\fBdpkg\fPによる処理の対象とならない。
.TP 
\fBdeinstall\fP
パッケージは deinstallation (設定ファイルを除くすべてのファイルを削除) するように選択されている
.TP 
\fBpurge\fP
パッケージは完全削除 (設定ファイルも含めたすべてのファイルを削除) するように選択されている。
.SS パッケージのフラグ
.TP 
\fBreinst\-required\fP
\fBreinst\-required\fP
状態にあるパッケージは、不正な状態にあり、再インストールが必要となっている。こうしたパッケージは、\fB\-\-force\-remove\-reinstreq\fP
オプションで強制しない限り、削除することができない。
.
.SH アクション
.TP 
\fB\-i\fP, \fB\-\-install\fP \fIpackage\-file\fP...
パッケージをインストールする。\fB\-\-recursive\fP または \fB\-R\fP オプションが指定されていた場合、\fIpackage\-file\fP
としてファイルではなくディレクトリを指定すること。

インストールは、以下のステップで構成されている。
.br

\fB1.\fP インストールする新しいパッケージの制御ファイルを展開する。
.br

\fB2.\fP 同一パッケージの別バージョンがインストール済の場合、新しいパッケージのインストール前に、インストール済パッケージの \fIprerm\fP
スクリプトを実行する。
.br

\fB3.\fP 新しいパッケージが \fIpreinst\fP スクリプトを提供している場合、実行する。
.br

\fB4.\fP 新しいファイルを展開する。同時に、失敗したときに元に戻せるように、古いファイルを保存する。
.br

\fB5.\fP 同一パッケージの別バージョンがインストール済の場合、古いパッケージの\fIpostrm\fP
スクリプトを実行する。このスクリプトは、新しいパッケージの
\fIpreinst\fPスクリプトの後に実行されることに注意すること。これは、新しいファイルが書き込まれるのと同時に古いファイルが削除されるためである。
.br

\fB6.\fP パッケージの設定を行う。処理の詳細については、\fB\-\-configure\fP を参照のこと。
.TP 
\fB\-\-unpack \fP\fIpackage\-file\fP...
パッケージを展開するが、設定はしない。\fB\-\-recursive\fP または \fB\-R\fP オプションが指定されていた場合、\fIpackage\-file\fP
としてファイルではなくディレクトリを指定すること。
.TP 
\fB\-\-configure \fP\fIpackage\fP...|\fB\-a\fP|\fB\-\-pending\fP
展開済だが未設定のパッケージを設定する。package の代わりに \fB\-a\fP もしくは\fB\-\-pending\fP
を指定した場合は、展開済だが未設定のパッケージすべてを設定する。

既に設定済のパッケージを再設定する場合は、\fBdpkg\-reconfigure\fP(8) コマンドを代わりに使用すること。

設定は、以下のステップで構成されている。
.br

\fB1.\fP 設定ファイルを展開する。同時になにか問題が発生した時に元に戻せるよう、古い設定ファイルをバックアップする。
.br

\fB2.\fP パッケージが提供している場合、\fIpostinst\fP スクリプトを実行する。
.TP 
\fB\-\-triggers\-only\fP \fIpackage\fP...|\fB\-a\fP|\fB\-\-pending\fP
トリガ処理のみを行う。待機しているトリガが処理される。パッケージ名が指定されている場合、該当パッケージのトリガのみが、必要な場合に一度だけ処理される。このオプションを使用すると、パッケージが不適切な
\fBtriggers\-awaited\fP もしくは\fBtriggers\-pending\fP 状態のままになってしまうかもしれない。これらの状態は
\fBdpkg \-\-configure \-\-pending\fP を後から実行することで対処できる。
.TP 
\fB\-r\fP, \fB\-\-remove\fP, \fB\-P\fP, \fB\-\-purge \fP\fIpackage\fP...|\fB\-a\fP|\fB\-\-pending\fP
インストール済のパッケージを削除する。\fB\-r\fP もしくは \fB\-\-remove\fP は、設定ファイル (conffile)
を除いたすべてを削除する。これにより、後ほど再インストールした時にパッケージの再設定を不要とすることができる
(ここでいう設定ファイルとは、制御ファイルの \fIDEBIAN/conffiles\fP に列挙されたファイルである) 。\fB\-P\fP もしくは
\fB\-\-purge\fP は、設定ファイルを含むすべてを強制削除する。パッケージ名の代わりに \fB\-a\fP もしくは\fB\-\-pending\fP
が指定された場合は、\fI/var/lib/dpkg/status\fP で remove もしくは purgeが指定されている展開済パッケージすべてが
remove もしくは完全削除される。設定ファイルによっては、設定スクリプトが生成、処理しているため、\fBdpkg\fP の管理下にない場合がある。この場合
\fBdpkg\fP はこれらのファイルを削除しないため、(\fBdpkg\fP から呼び出される) パッケージの \fIpostrm\fP
スクリプトが完全削除処理の際に、これらのファイルを削除する必要がある。当然であるが、削除対象となるのは、システムのディレクトリに存在しているファイルのみであり、個々のユーザのホームディレクトリにある設定ファイルは対象外である。

パッケージの削除は以下のステップで構成されている:
.br

\fB1.\fP \fIprerm\fP スクリプトを実行する。
.br

\fB2.\fP インストールしたファイルを削除する。
.br

\fB3.\fP \fIpostrm\fP スクリプトを実行する。
.br
.TP 
\fB\-\-update\-avail\fP, \fB\-\-merge\-avail\fP \fIPackages\-file\fP
\fBdpkg\fP や \fBdselect\fP
が管理する利用可能なパッケージの情報を更新する。\fB\-\-merge\-avail\fPアクションを指定すると、古い情報と \fIPackages\-file\fP
の情報とが統合される。\fB\-\-update\-avail\fP アクションを指定すると、古い情報は \fIPackages\-file\fP
の情報で置き換えられる。Debian と一緒に配布されている \fIPackages\-file\fP は、シンプルに\fIPackages\fP
という名前になっている。\fBdpkg\fP は、利用可能なパッケージの情報を\fI/var/lib/dpkg/available\fP に記録する。

\fIavailable\fP ファイルを取得し更新する簡便なコマンドが \fBdselect update\fP である。このファイルは \fBdselect\fP
の代わりに APT ベースのフロントエンドを使用する場合はほとんど無意味である。APT
は利用可能なパッケージを管理するシステムを独自に保持しているためである。
.TP 
\fB\-A\fP, \fB\-\-record\-avail\fP \fIpackage\-file\fP...
\fBdpkg\fP や \fBdselect\fP が管理する利用可能なパッケージの情報を、\fIpackage\-file\fP
で指定したパッケージの情報で更新する。\fB\-\-recursive\fP または \fB\-R\fP オプションが指定されていた場合、\fIpackage\-file\fP
としてファイルではなくディレクトリを指定すること。
.TP 
\fB\-\-forget\-old\-unavail\fP
現在は\fB廃止され\fPており、何も行われない。\fBdpkg\fP は、インストールされず利用できないパッケージの情報を自動的に消去する。
.TP 
\fB\-\-clear\-avail\fP
利用可能なパッケージについての情報を消去する。
.TP 
 \fB\-C\fP, \fB\-\-audit\fP
インストールが中断されているパッケージを検索する。dpkg はインストールを完了させるために行うべきことを提示する。
.TP 
\fB\-\-get\-selections\fP [\fIpackage\-name\-pattern\fP...]
選択したパッケージのリストを標準出力に出力する。パターンを指定しなかった場合は、(既に完全削除されているなどで)
インストールされていないパッケージは表示されない。
.TP 
\fB\-\-set\-selections\fP
標準入力から読み込んだファイルを用いて選択したパッケージのステータスを更新する。読み込むファイルは '\fIpackage\fP \fIstate\fP'
というフォーマットになっている必要がある。state は \fBinstall\fP, \fBhold\fP, \fBdeinstall\fP, \fBpurge\fP
のいずれかの値をとる。空行や '#' から始まるコメント行を使用してもよい。

The available database needs to be up\-to\-date for this command to be useful,
otherwise unknown packages will be ignored with a warning. See the
\fB\-\-update\-avail\fP and \fB\-\-merge\-avail\fP commands for more information.
.TP 
\fB\-\-clear\-selections\fP
essential 以外のすべてのパッケージのステータスを deinstall にする。このオプションは、\-\-set\-selection の直前で用いて
\-\-set\-selections で指定していないパッケージをすべて deinstall するために使用されることを想定している。
.TP 
\fB\-\-yet\-to\-unpack\fP
インストールするために選択されたが、何らかの理由でまだインストールされていないパッケージを検索する。
.TP 
\fB\-\-add\-architecture \fP\fIarchitecture\fP
\fIarchitecture\fP を、\fB\-\-force\-architecture\fP
を使用せずにパッケージをインストールすることが可能となるアーキテクチャのリストに追加する。\fBdpkg\fP がビルドされたアーキテクチャ (すなわち
\fB\-\-print\-architecture\fP の出力) は、常にリストに含まれる。
.TP 
\fB\-\-remove\-architecture \fP\fIarchitecture\fP
\fIarchitecture\fP を、\fB\-\-force\-architecture\fP
を使用せずにパッケージをインストールすることが可能となるアーキテクチャのリストから削除する。アーキテクチャが現在データベースで使用中だった場合、\fB\-\-force\-architecture\fP
が指定されていない限り、操作は拒否される。\fBdpkg\fP がビルドされたアーキテクチャ (すなわち \fB\-\-print\-architecture\fP
の出力) を、リストから削除することは決してできない。
.TP 
\fB\-\-print\-architecture\fP
\fBdpkg\fP がインストールするパッケージのアーキテクチャ (例えば "i386") を表示する。
.TP 
\fB\-\-print\-foreign\-architectures\fP
\fBdpkg\fP によるインストールを可能とする設定をされた、追加のアーキテクチャを改行で区切ったリストで表示する。
.TP 
\fB\-\-compare\-versions \fP\fIver1 op ver2\fP
.\" .TP
.\" .B \-\-command\-fd \fIn\fP
.\" Accept a series of commands on input file descriptor \fIn\fP. Note:
.\" additional options set on the command line, and through this file descriptor,
.\" are not reset for subsequent commands executed during the same run.
二項演算子 \fIop\fP を用いてバージョン番号を比較する。\fBdpkg\fP は、指定した条件を満たす場合は成功 (0) を、それ以外は失敗 (0 以外)
を返却する。演算子は \fIver1\fP や\fIver2\fP が空文字列の時の扱いによって、 2 種類に大別できる。\fBlt le eq ne ge
gt\fPは、空文字列をもっとも小さいバージョンと見なす。\fBlt\-nl le\-nl ge\-nl gt\-nl\fP
は、もっとも大きいバージョンとみなす。\fB< << <= = >= >> >\fP
は、control ファイルの文法との互換性を維持するためにのみ提供される。
.TP 
\fB\-?\fP, \fB\-\-help\fP
オプションに関する簡単なヘルプを表示する。
.TP 
\fB\-\-force\-help\fP
\fB\-\-force\-\fP\fIthing\fP オプションに関するヘルプを表示する。
.TP 
\fB\-Dh\fP, \fB\-\-debug=help\fP
デバッグ用オプションに関するヘルプを表示する。
.TP 
\fB\-\-version\fP
\fBdpkg\fP のバージョン情報を表示する。
.TP 
\fBdpkg\-deb actions\fP
以下のアクションの詳細については \fBdpkg\-deb\fP(1) を参照のこと。

.nf
\fB\-b\fP, \fB\-\-build\fP \fIdirectory\fP [\fIarchive\fP|\fIdirectory\fP]
    deb パッケージをビルドする。
\fB\-c\fP, \fB\-\-contents\fP \fIarchive\fP
    deb パッケージに含まれるファイル一覧を表示する。
\fB\-e\fP, \fB\-\-control\fP \fIfilename\fP [\fIdirectory\fP]
    パッケージから制御情報ファイルを展開する。
\fB\-x\fP, \fB\-\-extract\fP \fIarchive directory\fP
    パッケージによってインストールされるファイルをすべて展開する。
\fB\-X\fP, \fB\-\-vextract\fP \fIarchive directory\fP
    パッケージによってインストールされるファイルをすべて展開して表示する。
\fB\-f\fP, \fB\-\-field\fP  \fIarchive\fP [\fIcontrol\-field\fP...]
    パッケージの制御ファイルの各フィールドを表示する。
\fB\-\-fsys\-tarfile\fP \fIarchive\fP
    Debian パッケージに含まれるインストールされるファイルが格納された
    tar ファイルの内容を表示する。
\fB\-I\fP, \fB\-\-info\fP \fIarchive\fP [\fIcontrol\-file\fP...]
    パッケージに関する各種情報を表示する。
.fi

.TP 
\fBdpkg\-query actions\fP
以下のアクションの詳細は、\fBdpkg\-query\fP(1) を参照のこと。

.nf

\fB\-l\fP | \fB\-\-list\fP \fIpackage\-name\-pattern\fP ...
    指定したパターンにマッチする名前のパッケージの一覧を表示する。
\fB\-s\fP | \fB\-\-status\fP \fIpackage\-name\fP ...
    指定したパッケージの状態を報告する。
\fB\-L\fP | \fB\-\-listfiles\fP \fIpackage\-name\fP ...
    \fBpackage\-name\fP によってシステムにインストールされたファイルの一覧を表示する。
\fB\-S\fP | \fB\-\-search\fP \fIfilename\-search\-pattern\fP ...
    指定したファイルがどのパッケージからインストールされたか検索する。
\fB\-p\fP | \fB\-\-print\-avail\fP \fIpackage\-name\fP
    \fI/var/lib/dpkg/available\fP にある \fIpackage\-name\fP の詳細情報を表示する。
    APT ベースのフロントエンドを使っている場合は、\fBapt\-cache show\fP \fIpackage\-name\fP
    コマンドを代わりに使用すること。
.fi
.
.SH オプション
すべてのオプションは、コマンドラインと \fBdpkg\fP の設定ファイル\fI/etc/dpkg/dpkg.cfg\fP もしくは設定ディレクトリ
\fI/etc/dpkg/dpkg.cfg.d/\fP 内にあり、次のシェルパターン \(aq[0\-9a\-zA\-Z_\-]*\(aq) にマッチする名前の)
フラグメントファイルのいずれで指定してもよい。設定ファイルの各行は、(先頭のダッシュを削除することを除き、コマンドラインオプションとまったく同一の)
オプションもしくは (行頭が \fB#\fP からはじまる) コメントのいずれかを記述する。
.br
.TP 
\fB\-\-abort\-after=\fP\fInumber\fP
\fBdpkg\fP の処理を中断させるエラー数を変更する。デフォルトは 50 である。
.TP 
\fB\-B\fP, \fB\-\-auto\-deconfigure\fP
パッケージを削除するとき、削除するパッケージに依存した別のパッケージがインストールされている場合がある。このオプションを指定すると、削除するパッケージに依存しているパッケージの設定を自動的に取り消す。
.TP 
\fB\-D\fP\fIoctal\fP\fB, \-\-debug=\fP\fIoctal\fP
デバッグモードにする。 \fIoctal\fP は、以下の一覧 (将来のリリースでは変更される可能性があることに注意)
から、任意の値をビットごとの論理和で組み合わせた数値である。\fB\-Dh\fP または \fB\-\-debug=help\fP により指定可能な値が表示される。

      数値   説明
         1   一般的に有用な、処理の進行状況
         2   管理スクリプトの呼び出しと処理状況
        10   各ファイル処理の情報
       100   各ファイル処理の詳細情報
        20   各設定ファイルの情報
       200   各設定ファイルの詳細情報
        40   依存関係、競合関係
       400   依存関係、競合関係の詳細情報
     10000   トリガの有効化と処理状況
     20000   トリガ関連の詳細情報
     40000   トリガ関連の過剰ともいえる詳細情報
      1000   dpkg/info ディレクトリ関連など、あまり意味のない詳細情報
      2000   信じられないほど大量のあまり意味のない情報
.TP 
\fB\-\-force\-\fP\fIthings\fP, \fB\-\-no\-force\-\fP\fIthings\fP, \fB\-\-refuse\-\fP\fIthings\fP

指定した \fIthings\fP を強制実行 (force) もしくは拒否 (refuse) する (\fBno\-force\fPと \fBrefuse\fP
は同じ意味) 。\fIthings\fP には、以下の項目をコンマで区切って列挙する。これらの項目は \fB\-\-force\-help\fP
オプションで表示される。(*) マークのあるものは、デフォルトで強制実行される。

\fI警告:
以下のオプションは、熟練ユーザ以外による使用を基本的に想定していない。影響を完全に理解しないままに使用した場合、システム全体が機能不全に陥る可能性がある。\fP

\fBall\fP: 全ての強制オプションを指定する(または指定しない)。

\fBdowngrade\fP(*): より新しいバージョンがすでにインストールされていたとしても、指定したパッケージをインストールする。

\fI警告: 現在のところ dpkg
はダウングレードの際に依存関係のチェックをまったく行わない。そのため、ダウングレードが別のパッケージの依存関係に問題を発生させる可能性についても警告されない。これは深刻な副作用を引き起こす可能性があり、必須のシステムコンポーネントをダウングレードした場合、システム全体が機能不全に陥ってしまうこともありうる。充分注意して使用すること。\fP

\fBconfigure\-any\fP: 指定したパッケージが依存しており、すでに展開されているが、まだ設定されていないパッケージも一緒に設定をする。

\fBhold\fP: たとえ "hold" とマークされていても、そのパッケージの処理をする。

\fBremove\-reinstreq\fP:
問題が発生しており、再インストールが必要だとマークされていた場合でも、パッケージを削除する。これは、パッケージの一部が \fBdpkg\fP
から認識されない状態でシステムに残置されてしまう状況を引き起こす場合がある。

\fBremove\-essential\fP: essential と見なされるパッケージであっても削除する。essential
パッケージには、もっとも基本となる UNIX
コマンドが含まれる。これらを削除すると、システム全体が動作しなくなるため、本オプションは注意して使用すること。

\fBdepends\fP: すべての依存関係の問題を警告として扱う。

\fBdepends\-version\fP: 依存関係の確認の際に、バージョンを無視する。

\fBbreaks\fP: 別のパッケージの機能不全を引き起こす場合でもインストールする。

\fBconflicts\fP: 他のパッケージと競合してもインストールする。たいていはいくつかファイルを上書きすることになるため、危険である。

\fBconfmiss\fP:
設定ファイルが存在せず、パッケージ中のバージョンが変更された際に、存在しない設定ファイルを常にインストールする。これは、ファイルに対する変更
(ファイル削除) を保持しないことを意味するため、危険である。

\fBconfnew\fP:
設定ファイルが変更されており、パッケージ中のバージョンも変更されていた場合、確認なしに新しいバージョンをインストールする。ただし、\fB\-\-force\-confdef\fP
が同時に指定されていた場合は、デフォルトの動作が優先される。

\fBconfold\fP:
設定ファイルが変更されており、パッケージ中のバージョンも変更されていた場合、確認なしに古いバージョンを保持する。ただし、\fB\-\-force\-confdef\fP
が同時に指定されていた場合は、デフォルトの動作が優先される。

\fBconfdef\fP: conffile
が変更されており、パッケージ中のバージョンも変更されていた場合、デフォルトの動作を実行する。デフォルトの動作が未定義で、\fB\-\-force\-confnew\fP
と \fB\-\-force\-confold\fP
のいずれも設定されていなかった場合は、ユーザに確認を求めるため、処理を中断する。いずれかが設定されている場合は、それによって最終的な動作が決定される。

\fBconfask\fP:
設定ファイルが変更されていた場合、パッケージバージョンが変更されていない場合でも、パッケージ収録のものと置き換えるかどうかを確認する。\fB\-\-force\-confmiss\fP,
\fB\-\-force\-confnew\fP, \fB\-\-force\-confold\fP, または
\fB\-\-force\-confdef\fPのいずれかが設定されている場合は、それによって最終的な動作が決定される。

\fBoverwrite\fP: あるパッケージで提供されているファイルを、インストールするパッケージのファイルで上書きする。

\fBoverwrite\-dir\fP: あるパッケージで提供されているディレクトリを、インストールするパッケージのファイルで上書きする。

\fBoverwrite\-diverted\fP: 退避 (divert) した古いファイルを現在のファイルで上書きする。

\fBunsafe\-io\fP: 展開の際に安全な I/O
処理を行わない。現在のところ、これはファイル名の変更前にファイルシステムの同期を行わないことを意味する。同期を行った場合、ファイルシステムによっては顕著な性能低下が発生することが知られている。不幸なことに、まず第一に安全な
I/O を必要としているのは、信頼性の低い I/O 処理を行っており、突然のシステム停止の際に 0
バイト長のファイルを作成してしまう、このような性能低下が発生するファイルシステム自身である。

\fI注記\fP: この事象の主たる発生元である ext4 では、本オプションの代わりにマウントオプション \fBnodelalloc\fP
の使用を検討してほしい。これはパフォーマンスの低下を抑えつつ、データを安全に扱うことができる。後者は、ファイルシステム上において、アトミックな
rename 処理の前に同期を行わないソフトウェアが、突然のシステム停止の際に 0 バイト長のファイルを作成できないようにすることで実現している。

\fI警告: このオプションはパフォーマンスを向上させるかもしれないが、同時にデータ喪失のリスクを高める。使用に際してはこの点の充分注意すること。\fP

\fBarchitecture\fP: パッケージのアーキテクチャが誤っている、もしくはアーキテクチャが存在しない場合であっても、処理を行う。

\fBbad\-version\fP: パッケージのバージョンが誤っていても処理を続行する。

\fBbad\-path\fP: 重要なプログラムが \fBPATH\fP に含まれていなくても実行する。問題が起きる可能性が高い。

\fBnot\-root\fP: root 以外でも、インストール (または削除) を試行する。

\fBbad\-verify\fP: 正当性認証チェックに失敗してもパッケージをインストールする。

.TP 
\fB\-\-ignore\-depends\fP=\fIpackage\fP,...
指定したパッケージに関する依存関係の確認を行わない (実際は、依存関係の確認は行われるが、競合が発生しても警告メッセージのみで処理を続行する)。
.TP 
\fB\-\-no\-act\fP, \fB\-\-dry\-run\fP, \fB\-\-simulate\fP
実行されるべき処理をすべて行うが、いかなる変更も書き込まない。これは、一切変更を行わずに、指定したアクションによって何が起こるかを確認する際に用いられる。

オプション \fB\-\-no\-act\fP は、必ずアクションパラメータより前で指定すること。さもなくば、望ましくない結果が発生することになる
(例えば、\fBdpkg \-\-purge foo \-\-no\-act\fP
というコマンドを実行させた場合、変更は一切させないつもりかも知れないが、実際には、パッケージ foo を完全削除してしまってから、\-\-no\-act
という名前のパッケージの完全削除処理が行われる)。
.TP 
\fB\-R\fP, \fB\-\-recursive\fP
指定したディレクトリを再帰的に検索し、\fB*.deb\fP というパターンにマッチする通常ファイルすべてに処理を行う。これは、\fB\-i\fP, \fB\-A\fP,
\fB\-\-install\fP, \fB\-\-unpack\fP, \fB\-\-avail\fP アクションに使うことができる。
.TP 
\fB\-G\fP
インストール済のパッケージのバージョンの方が新しければ、パッケージをインストールしない。これは \fB\-\-refuse\-downgrade\fP
の別名である。
.TP 
\fB\-\-admindir=\fP\fIdir\fP
デフォルトの管理ディレクトリを変更する (デフォルトは
\fI/var/lib/dpkg\fP)。管理ディレクトリには、パッケージのインストール状況に関する情報が格納された多種多様なファイルが存在する。
.TP 
\fB\-\-instdir=\fP\fIdir\fP
デフォルトのインストールディレクトリを変更する。インストールディレクトリは、パッケージのインストール先となるディレクトリである。\fBinstdir\fP
は、パッケージのインストールスクリプトが実行される前に \fBchroot\fP(2) にわたされるディレクトリでもある。つまり、スクリプトは
\fBinstdir\fP をルートディレクトリとみなす (デフォルトは \fI/\fP である)。
.TP 
\fB\-\-root=\fP\fIdir\fP
\fBroot\fP を変更すると、\fBinstdir\fP が \fIdir\fP に変更され、\fBadmindir\fP が
\fIdir\fP\fB/var/lib/dpkg\fP に変更される。
.TP 
\fB\-O\fP, \fB\-\-selected\-only\fP
インストール対象として選択されたパッケージのみを処理する。選択のマーク付けそのものは、\fBdselect\fP や \fBdpkg\fP
を使って行なう。例えば、パッケージ削除の際には、パッケージは削除対象としてマーク付けがされる。
.TP 
\fB\-E\fP, \fB\-\-skip\-same\-version\fP
すでに同じバージョンのパッケージがインストールされている場合、パッケージをインストールしない。
.P
\fB\-\-pre\-invoke=\fP\fIcommand\fP
.br
\fB\-\-post\-invoke=\fP\fIcommand\fP
.RS
dpkg が \fIunpack\fP, \fIconfigure\fP, \fIinstall\fP, \fItriggers\-only\fP, \fIremove\fP,
\fIpurge\fP の各アクションを実行する前後に \*(lqsh \-c\*(rq
によって起動されるフックコマンドを指定する。このオプションは複数回指定することができ、その際オプションの指定順は保持される。設定ファイルにおける指定の方が優先度が高い。現在のアクションに対するフックは、環境変数
\fBDPKG_HOOK_ACTION\fP に設定される。フロントエンドは、ある一回の操作中に dpkg
を複数回呼び出す場合がある。そのため、フックについても想定していた回数以上に呼び出される場合がある点に留意すること。
.RE
.P
\fB\-\-path\-exclude=\fP\fIglob\-pattern\fP
.br
\fB\-\-path\-include=\fP\fIglob\-pattern\fP
.RS
\fIglob\-pattern\fP
によりパスのフィルタ条件を指定する。これは、インストールの際に指定したパターンにマッチしたパスのファイルをインストールの対象から除外したり、除外したパスの一部を再度インストール対象としたりするために用いられる。

\fI警告: 除外したパスによっては、システム全体が動作しなくなる可能性がある。危険性を充分理解した上で、注意して使用すること。\fP

glob\-pattern には、シェルと同様のワイルドカードを使用することができる。'*' は、空文字列と '/'
を含むすべての文字列にマッチする。例えば、\fI'/usr/*/READ*'\fP は \fI'/usr/share/doc/package/README'\fP
にマッチする。例によって '?' は任意の 1 文字 (こちらも '/' を含む) にマッチする。'['
は、文字のリスト、範囲、補集合を含む文字クラスの開始を意味する。パターンマッチングの詳細は \fBglob\fP(7) を参照のこと。注記:
現在の実装では、安全サイドに倒してファイル展開の際のエラーを抑止しているため、ディレクトリやシンボリックリンクが過度にマッチしてしまう。この挙動は将来的に修正されるかもしれない。

これは、特定のパス以外のパスをすべて除外するために使用することができる。典型的な例を以下に示す:

.nf
\fB\-\-path\-exclude=/usr/share/doc/*\fP
\fB\-\-path\-include=/usr/share/doc/*/copyright\fP
.fi

これは、copyright ファイル以外のすべてのドキュメントファイルを削除する。

この 2
つのオプションは複数回指定することができ、交互に指定していくことも可能である。その場合は指定された順番どおりに処理が行われ、ファイル名に対して最後にマッチしたルールによって、処理が決定する。
.RE
.TP 
\fB\-\-status\-fd \fP\fIn\fP
コンピュータが解釈可能な形式のパッケージの状態と処理の進行状況に関する情報とをファイルディスクリプタ \fIn\fP
に引き渡す。このオプションは複数回指定することができる。情報は通常 1 行に 1 レコードずつ、以下のいずれかの形式で記載される:
.RS
.TP 
\fBstatus: \fP\fIpackage\fP\fB: \fP\fIstatus\fP
パッケージのステータスが変更された。\fIstatus\fP が新しいステータスである。
.TP 
\fBstatus: \fP\fIpackage\fP\fB : error : \fP\fIextended\-error\-message\fP
エラーが発生した。\fIextended\-error\-message\fP 中の改行は、出力の前に空白文字に置き換えられる。
.TP 
\fBstatus: \fP\fIfile\fP\fB : conffile\-prompt : '\fP\fIreal\-old\fP\fB' '\fP\fIreal\-new\fP\fB' \fP\fIuseredited\fP\fB \fP\fIdistedited\fP
ユーザは設定ファイルの処理に関する確認をされている。
.TP 
\fBprocessing: \fP\fIstage\fP\fB: \fP\fIpackage\fP
stage に関する処理が開始される前に送信される。\fIstage\fP は、\fBupgrade\fP, \fBinstall\fP
(いずれも展開が開始される前に送信される), \fBconfigure\fP, \fBtrigproc\fP, \fBdisappear\fP, \fBremove\fP,
\fBpurge\fP のいずれかになる。
.RE
.TP 
\fB\-\-status\-logger\fP=\fIcommand\fP
コンピュータが解釈可能な形式のパッケージの状態と処理の進行状況に関する情報とをシェル \fIcommand\fP
の標準入力に引き渡す。このオプションは複数回指定することができる。出力形式は \fB\-\-status\-fd\fP と同一である。
.RE
.TP 
\fB\-\-log=\fP\fIfilename\fP
状態の変更やアクションの記録先を、デフォルトの \fI/var/log/dpkg.log\fP から \fIfilename\fP
に変更する。このオプションを複数回指定した場合は、最後に指定したファイル名が使われる。ログメッセージの形式は次のとおり。状態の変更は、`YYYY\-MM\-DD
HH:MM:SS status \fIstate\fP \fIpkg\fP \fIinstalled\-version\fP。アクションは、`YYYY\-MM\-DD
HH:MM:SS \fIaction\fP \fIpkg\fP \fIinstalled\-version\fP \fIavailable\-version\fP
で、\fIaction\fP は、\fBinstall\fP, \fBupgrade\fP, \fBremove\fP, \fBpurge\fP
のいずれかである。設定ファイルの変更は、`YYYY\-MM\-DD HH:MM:SS conffile \fIfilename\fP \fIdecision\fP'
で、\fIdecision\fP は \fBinstall\fP か \fBkeep\fPのいずれかである。
.TP 
\fB\-\-no\-debsig\fP
パッケージの署名を確認しない。
.TP 
\fB\-\-no\-triggers\fP
今回の実行に際しては、いかなるトリガも実行させない (トリガの有効化自体は記録される)。\fB\-\-configure\fP \fIpackage\fP や
\fB\-\-triggers\-only\fP \fIpackage\fP と同時に指定した場合、対象パッケージの postinst
はトリガの実行が必要であっても、実行されることになる。このオプションを使用すると、パッケージが\fBtriggers\-awaited\fP や
\fBtriggers\-pending\fP のまま不適切な状態で残ってしまうことがある。これは後ほど \fBdpkg \-\-configure
\-\-pending\fP を実行することで解消される。
.TP 
\fB\-\-triggers\fP
先に指定した \fB\-\-no\-triggers\fP を無効にする。
.
.SH ファイル
.TP 
\fI/etc/dpkg/dpkg.cfg.d/[0\-9a\-zA\-Z_\-]*\fP
フラグメントファイルの設定
.TP 
\fI/etc/dpkg/dpkg.cfg\fP
オプションのデフォルト値を記述する設定ファイル。
.TP 
\fI/var/log/dpkg.log\fP
デフォルトのログファイル (\fI/etc/dpkg/dpkg.cfg\fP(5) と \fB\-\-log\fP オプションも参照のこと)。
.P
以下のファイルのパスは、デフォルトのディレクトリ配下に存在している場合である。ファイルの位置を変更する方法については、\fB\-\-admindir\fP
オプションを参照すること。
.TP 
\fI/var/lib/dpkg/available\fP
使用できるパッケージの一覧。
.TP 
\fI/var/lib/dpkg/status\fP
使用できるパッケージのステータス情報。このファイルには、パッケージが削除対象としてマークされているか、インストール済みかどうかといった情報が含まれている。詳細は、\fBパッケージに関する情報\fP
セクションを参照すること。

ステータスファイルは、日時で \fI/var/backups\fP
にバックアップされる。これはファイルシステムまわりのトラブルで、ファイルが消失したり破損したりした際に有用である。
.P
以下のファイルはバイナリパッケージを構成するファイルである。これらのファイルに関する詳細情報は、\fBdeb\fP(5) を参照のこと。
.TP 
\fIcontrol\fP
.TP 
\fIconffiles\fP
.TP 
\fIpreinst\fP
.TP 
\fIpostinst\fP
.TP 
\fIprerm\fP
.TP 
\fIpostrm\fP
.
.SH 環境変数
.TP 
\fBHOME\fP
設定されていた場合、\fBdpkg\fP は、変数の値をユーザ固有の設定ファイルの参照先のディレクトリとして使用する。
.TP 
\fBTMPDIR\fP
設定されていた場合、\fBdpkg\fP は、変数の値を一時ファイルおよびディレクトリを作成するディレクトリとして使用する。
.TP 
\fBPAGER\fP
\fBdpkg\fP が設定ファイルの内容を表示するときに、実際に起動するプログラム。
.TP 
\fBSHELL\fP
\fBdpkg\fP が新しいシェルを起動するときに、実際に起動するプログラム。
.TP 
\fBCOLUMNS\fP
\fBdpkg\fP が整形済テキストを表示する時に使用するコラム数。現在は \-l オプションでのみ参照されている。
.TP 
\fBDPKG_SHELL_REASON\fP
状況を確認するために設定ファイルのプロンプトから起動されたシェルに対して、\fBdpkg\fP により設定される。現在のところ有効な値は
\fBconffile\-prompt\fP のみである。
.TP 
\fBDPKG_CONFFILE_OLD\fP
状況を確認するために設定ファイルのプロンプトから起動されたシェルに対して、\fBdpkg\fP により設定される。古い設定ファイルのパスが含まれる。
.TP 
\fBDPKG_CONFFILE_NEW\fP
状況を確認するために設定ファイルのプロンプトから起動されたシェルに対して、\fBdpkg\fP により設定される。新しい設定ファイルのパスが含まれる。
.TP 
\fBDPKG_RUNNING_VERSION\fP
メンテナスクリプトの環境に対して、\fBdpkg\fP により現在実行中の \fBdpkg\fPのバージョンが設定される。
.TP 
\fBDPKG_MAINTSCRIPT_PACKAGE\fP
メンテナスクリプトの環境に対して、\fBdpkg\fP により処理対象のパッケージ名が設定される。
.TP 
\fBDPKG_MAINTSCRIPT_ARCH\fP
メンテナスクリプトの環境に対して、\fBdpkg\fP によりパッケージのビルド対象となったアーキテクチャの情報が設定される。
.TP 
\fBDPKG_MAINTSCRIPT_NAME\fP
メンテナスクリプトの環境に対して、\fBdpkg\fP により実行中のスクリプト名 (preinst, postinst, prerm, postrm)
が設定される。
.
.SH 例
\fBvi\fP(1) エディタに関連するインストール済パッケージの一覧を表示する。(\fBdpkg\-query\fP
は、デフォルトでは利用可能なファイルについて一切表示しないことに注意。これを行うには、代わりに \fBdpkg\-query\fP
\fB\-\-load\-avail\fP オプションを使用すること):
.br
     \fBdpkg \-l \(aq*vi*\(aq\fP
.br

2 つのパッケージに関して、\fI/var/lib/dpkg/available\fP にある項目を表示する。
.br
     \fBdpkg \-\-print\-avail elvis vim | less\fP
.br

パッケージの一覧を自分で検索する。
.br
     \fBless /var/lib/dpkg/available\fP
.br

インストールされた elvis パッケージを削除する。
.br
     \fBdpkg \-r elvis\fP
.br

パッケージをインストールするには、まずパッケージをアーカイブや CDROM から探し出す必要がある。"available" ファイルによれば、vim
パッケージは "editors" セクションに属している。
.br
     \fBcd /media/cdrom/pool/main/v/vim\fP
     \fBdpkg \-i vim_4.5\-3.deb\fP
.br

パッケージ選択状況のコピーを作成する。
.br
     \fBdpkg \-\-get\-selections >myselections\fP
.br

You might transfer this file to another computer, and after having updated
the available database there with your package manager frontend of choice
(see https://wiki.debian.org/Teams/Dpkg/FAQ for more details), for example:
.br
     \fBavail=`mktemp`\fP
     \fBapt\-cache dumpavail >"$avail"\fP
     \fBdpkg \-\-merge\-avail "$avail"\fP
     \fBrm "$avail"\fP
.br
you can install it with:
.br
     \fBdpkg \-\-clear\-selections\fP
     \fBdpkg \-\-set\-selections <myselections\fP
.br

これは実際にはインストールも削除もせずに、単に要求しているパッケージの選択状態を設定するだけであることに注意。要求しているパッケージを実際にダウンロード、インストールするには別のアプリケーションが必要である。例えば、\fBapt\-get
dselect\-upgrade\fP を実行する。

通常、パッケージの選択状態を変更するには \fBdselect\fP(1) を使用するほうが便利である。
.br
.
.SH 追加機能
\fBapt\fP、\fBaptitude\fP、\fBdebsums\fP パッケージをインストールすると、これ以外の機能が追加される。
.
.SH 関連項目
\fBaptitude\fP(1), \fBapt\fP(1), \fBdselect\fP(1), \fBdpkg\-deb\fP(1), \fBdpkg\-query\fP(1),
\fBdeb\fP(5), \fBdeb\-control\fP(5), \fBdpkg.cfg\fP(5), \fBdpkg\-reconfigure\fP(8).
.
.SH バグ
\fB\-\-no\-act\fP の提供する情報はたいていの場合、不充分である。
.
.SH 著者
\fBdpkg\fP に貢献した人の一覧については、\fI/usr/share/doc/dpkg/THANKS\fP を参照のこと。
.SH 翻訳者
高橋 基信 <monyo@monyo.com>.
喜瀬 浩 <kise@fuyuneko.jp>.
関戸 幸一 <sekido@mbox.kyoto-inet.or.jp>.
鍋谷 栄展 <nabe@debian.or.jp>.
倉澤 望 <nabetaro@debian.or.jp>.
石川 睦 <ishikawa@linux.or.jp>.
鵜飼 文敏 <ukai@debian.or.jp>.
中野 武雄 <nakano@apm.seikei.ac.jp>.
.SH 翻訳校正
Debian JP Documentation ML <debian-doc@debian.or.jp>.
