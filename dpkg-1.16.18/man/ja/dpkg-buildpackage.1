.\" dpkg manual page - dpkg-buildpackage(1)
.\"
.\" Copyright 息 1995-1996 Ian Jackson
.\" Copyright 息 2000 Wichert Akkerman <wakkerma@debian.org>
.\" Copyright 息 2007-2008 Frank Lichtenheld <djpig@debian.org>
.\" Copyright 息 2008-2011 Guillem Jover <guillem@debian.org>
.\" Copyright 息 2008-2012 Rapha谷l Hertzog <hertzog@debian.org>
.\"
.\" This is free software; you can redistribute it and/or modify
.\" it under the terms of the GNU General Public License as published by
.\" the Free Software Foundation; either version 2 of the License, or
.\" (at your option) any later version.
.\"
.\" This is distributed in the hope that it will be useful,
.\" but WITHOUT ANY WARRANTY; without even the implied warranty of
.\" MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
.\" GNU General Public License for more details.
.\"
.\" You should have received a copy of the GNU General Public License
.\" along with this program.  If not, see <http://www.gnu.org/licenses/>.
.
.\"*******************************************************************
.\"
.\" This file was generated with po4a. Translate the source file.
.\"
.\"*******************************************************************
.TH dpkg\-buildpackage 1 2012\-05\-04 "Debian Project" "dpkg ユーティリティ"
.SH 名前
dpkg\-buildpackage \- バイナリパッケージおよびソースパッケージのビルド
.
.SH 書式
\fBdpkg\-buildpackage\fP [\fIoption\fP...]
.
.SH 説明
\fBdpkg\-buildpackage\fP は、Debian パッケージのビルドを自動化するプログラムである。これには以下のステップが含まれる:
.IP \fB1.\fP 3
様々な環境変数 (\fB環境変数\fP を参照のこと) を定義することで、ビルド環境を設定し、\fBdpkg\-source \-\-before\-build\fP
を呼び出す (\fB\-T\fP もしくは \fB\-\-target\fPが指定されていない限り)。
.IP \fB2.\fP 3
ビルドにおける依存関係が満たされているか、競合が発生していないかをチェックする (\fB\-d\fP が指定されていない限り)。
.IP \fB3.\fP 3
\fB\-T\fP もしくは \fB\-\-target\fP
オプションにより、ビルドのターゲットが指定されている場合は、ターゲットを呼び出して、そこで実行を停止する。それ以外の場合は \fBfakeroot
debian/rules clean\fP を呼び出し、ビルドツリーをクリアする (\fB\-nc\fP が指定されていない限り)。
.IP \fB4.\fP 3
\fBdpkg\-source \-b\fP を呼び出し、ソースパッケージを生成する (\fB\-b\fP, \fB\-B\fP, \fB\-A\fP
によってバイナリパッケージのみのビルドが指定されていない限り)。
.IP \fB5.\fP 3
\fBfakeroot debian/rules\fP \fIbinary\-target\fP に続き、\fBdebian/rules\fP
\fBbuild\-target\fP を呼び出す (\fB\-S\fP によってソースパッケージのみのビルドが指定されていない限り)。\fIbuild\-target\fP
および \fIbinary\-target\fP は \fBbuild\fP および \fBbinary\fP (デフォルト、もしくは \fB\-b\fP
が指定されていた場合)、\fBbuild\-arch\fP および \fBbinary\-arch\fP (\fB\-B\fP
が指定されていた場合)、\fBbuild\-indep\fP および \fBbinary\-indep\fP (\fB\-A\fP が指定されていた場合)
のいずれかの値をとる。
.IP \fB6.\fP 3
\fBgpg\fP を呼び出し、\fB.dsc\fP ファイルに署名を行う (\fB\-us\fP が指定されていない限り)。
.IP \fB7.\fP 3
\fBdpkg\-genchanges\fP を呼び出して、\fB.changes\fP ファイルを生成する。\fBdpkg\-buildpackage\fP
のオプションの多くが \fBdpkg\-genchanges\fP に引き継がれる。
.IP \fB8.\fP 3
\fBgpg\fP を呼び出し、\fB.changes\fP ファイルに署名を行う (\fB\-uc\fP が指定されていない限り)。
.IP \fB9.\fP 3
\fB\-tc\fP が指定されていた場合、\fBfakeroot debian/rules clean\fP が再度呼び出される。最後に \fBdpkg\-source
\-\-after\-build\fP が呼び出される。
.
.SH オプション
.TP 
\fB\-b\fP
バイナリパッケージのみのビルドを指定する。ソースファイルはビルドされず、配布もされない。オプションは \fBdpkg\-genchanges\fP に渡される。
.TP 
\fB\-B\fP
アーキテクチャ依存のパッケージについて、バイナリパッケージのみのビルドを指定する。オプションは \fBdpkg\-genchanges\fP に渡される。
.TP 
\fB\-A\fP
アーキテクチャ非依存のパッケージについて、バイナリパッケージのみのビルドを指定する。オプションは \fBdpkg\-genchanges\fP に渡される。
.TP 
\fB\-S\fP
ソースパッケージのみのビルドを指定する。バイナリパッケージは作成されない。オプションは \fBdpkg\-genchanges\fP に渡される。
.TP 
\fB\-F\fP
バイナリパッケージとソースパッケージの両方をビルドする、通常のフルビルドを指定する。これはビルドオプションを指定しなかった際のデフォルトの挙動である。
.P
\fB\-\-target=\fP\fItarget\fP
.br
\fB\-\-target \fP\fItarget\fP
.br
\fB\-T\fP\fItarget\fP
.RS
ビルド環境の設定後に、\fBdebian/rules\fP \fItarget\fP を呼び出し、そこでパッケージのビルド処理を中止する。\fB\-\-as\-root\fP
も設定されていた場合、コマンドは root として実行される (\fB\-r\fP も参照のこと)。Debian policy によって、公式に root
での実行が必須とされているターゲットについては、本オプションは不要である。
.RE
.TP 
\fB\-\-as\-root\fP
\fB\-\-target\fP と併せて指定された場合のみ有効であり、target の実行に root 権限が必要であることを指定する。
.P
\fB\-si\fP
.br
\fB\-sa\fP
.br
\fB\-sd\fP
.br
\fB\-v\fP\fIversion\fP
.br
\fB\-C\fP\fIchanges\-description\fP
.br
\fB\-m\fP\fImaintainer\-address\fP
.br
\fB\-e\fP\fImaintainer\-address\fP
.RS
\fBdpkg\-genchanges\fP にそのまま引き渡される。そちらのマニュアルページを参照のこと。
.RE
.TP 
\fB\-a\fP\fIarchitecture\fP
ビルド対象となる Debian アーキテクチャを指定する。ビルドを実行するマシンのアーキテクチャは自動的に判別され、ホストマシンのデフォルト値となる。
.TP 
\fB\-t\fP\fIgnu\-system\-type\fP
ビルド対象となる GNU システムタイプを指定する。これは \-a オプションの代わりとしてターゲットの Debian
アーキテクチャに対応するデフォルトの GNU システムタイプを上書きするために用いられる。
.TP 
\fB\-j\fP\fIjobs\fP
同時に実行させることが可能なジョブの数であり、\fBmake\fP(1) の同名のオプションと同じ意味を持つ。MAKEFLAGS
環境変数に追加され、後に続くすべての make の呼び出しに、このオプションが引き継がれる。このオプションは、debian/rules
ファイルがこの情報を使用できるように DEB_BUILD_OPTIONS 環境変数に対しても \fBparallel=\fP\fIjobs\fP
を追加する。DEB_BUILD_OPTIONS 環境変数に \fBparallel=\fP\fIjobs\fP が設定されていた場合、\fB\-j\fP
オプションの値は上書きされる。
.TP 
\fB\-D\fP
ビルドの依存関係と競合をチェックし、問題がある場合は処理を中断させる。これはデフォルトの挙動である。
.TP 
\fB\-d\fP
ビルドの依存関係と競合をチェックしない。
.TP 
\fB\-nc\fP
ソースツリーを消去しない (\fB\-B\fP, \fB\-A\fP, \fB\-S\fP いずれもが指定されない場合は、\fB\-b\fP が指定されたと見なされる)。
.TP 
\fB\-tc\fP
パッケージのビルド後にソースツリーを消去する (\fIgain\-root\-command\fP \fBdebian/rules clean\fP が用いられる)。
.TP 
\fB\-r\fP\fIgain\-root\-command\fP
\fBdpkg\-buildpackage\fP がビルド処理の一部を root
権限で実行する必要がある場合、このオプションが指定されていれば、実行するコマンドの前に \fIgain\-root\-command\fP
が付けられる。このオプションが指定されていなかった場合は、\fBfakeroot\fP
が存在していれば、それがデフォルトで用いられる。\fIgain\-root\-command\fP は\fBPATH\fP
上のプログラム名である必要があり、実際に実行したいコマンドに続き、そのコマンドの引数を引数として指定する。\fIgain\-root\-command\fP には
(スペースで区切られた) パラメータを含めてもよいが、シェルのメタキャラクタを含めることはできない。\fIgain\-root\-command\fP は通常
\fBfakeroot\fP, \fBsudo\fP, \fBsuper\fP, \fBreally\fP などである。\fBsu\fP
は、実行したいコマンドに引数を個々に引き渡すのではなく、\fB\-c\fP を用いてユーザのシェルを起動するだけであるため適切ではない。
.TP 
\fB\-R\fP\fIrules\-file\fP
Debian パッケージのビルドの際は、通常 \fBdebian/rules\fP
コマンドが幾つかの標準的な引数を付けて実行される。このオプションにより、パッケージのビルドの際に別のプログラムを使用することが可能となる
(スペースで区切られた引数を含めることも可能である)。標準のルールファイルを別の make プログラムで実行する (例えば \fIrules\-file\fP
の代わりに \fB/usr/local/bin/make \-f debian/rules\fP を使用する) ために使用することもできる。
.TP 
\fB\-p\fP\fIsign\-command\fP
\fBdpkg\-buildpackage\fP がソースコントロール (\fB.dsc\fP) ファイルや \fB.changes\fP ファイルに署名するために GPG
を実行する必要がある場合、\fBgpg\fP の代わりに\fIsign\-command\fP を実行する (必要に応じて \fBPATH\fP を検索する)
。\fIsign\-command\fP には \fBgpg\fP に引き渡されるすべての引数が引き渡される。\fIsign\-command\fP
にはスペースやシェルのメタキャラクタを含めてはならない。
.TP 
\fB\-k\fP\fIkey\-id\fP
パッケージに署名する際に使用する鍵のIDを指定する。
.TP 
\fB\-us\fP
ソースパッケージに署名しない。
.TP 
\fB\-uc\fP
\&\fB.changes\fP ファイルに署名しない。
.P
\fB\-i\fP[\fIregexp\fP]
.br
\fB\-I\fP\fI[pattern]\fP
.br
\fB\-s\fP[\fBnsAkurKUR\fP]
.br
\fB\-z\fP, \fB\-Z\fP
.br
.RS
\fBdpkg\-source\fP にそのまま引き渡される。そちらのマニュアルページを参照のこと。
.RE
.TP 
\fB\-\-source\-option=\fP\fIopt\fP
\fBdpkg\-source\fP に \fIopt\fP オプションを引き渡す。
.TP 
\fB\-\-changes\-option=\fP\fIopt\fP
\fBdpkg\-genchanges\fP に \fIopt\fP オプションを引き渡す。
.P
\fB\-\-admindir=\fP\fIdir\fP
.br
\fB\-\-admindir \fP\fIdir\fP
.RS
\fBdpkg\fP データベースの位置を変更する。デフォルトの位置は \fI/var/lib/dpkg\fP である。
.RE
.TP 
\fB\-?\fP, \fB\-\-help\fP
利用方法を表示して終了する。
.TP 
\fB\-\-version\fP
バージョン情報を表示して終了する。
.
.SH 環境変数
\fBdpkg\-buildpackage\fP が幾つかの変数をエクスポートしていたとしても、\fBdebian/rules\fP
はその存在に依存してはならない。代わりに必要な値を取得するためのインタフェースを使用すること。
.SS "dpkg\-architecture によって設定される変数"
\fBdpkg\-architecture\fP は \fB\-a\fP および \fB\-t\fP を引数として呼び出される。このコマンドの \fB\-s\fP
オプションによって設定された変数はビルド環境にマージされる。
.SS コンパイラフラグのエクスポート停止
1.14.17 から 1.16.1 の間では、\fBdpkg\-buildpackage\fP が \fBdpkg\-buildflags\fP
によって返却される値としてコンパイラフラグ (\fBCFLAGS\fP, \fBCXXFLAGS\fP, \fBFFLAGS\fP, \fBCPPFLAGS\fP,
\fBLDFLAGS\fP) をエクスポートしていた。現在のバージョンでは、行われていない。
.
.SH 後方互換性
バージョン 1.16.2 以降の \fBdpkg\-buildpackage\fP は、\fBbuild\-arch\fP および \fBbuild\-indep\fP
ターゲットを使用している。これらのターゲットは必須である。しかし、既存パッケージで問題が発生するのを回避し、円滑な移行を行うために、\fBmake \-f
debian/rules \-qn\fP \fIbuild\-target\fP が戻り値として 2 を返却した場合は、\fBbuild\fP
ターゲットにフォールバックする。
.SH バグ
\fIgain\-root\-command\fP および \fIsign\-command\fP
の先頭の引数として、スペースやシェルのメタキャラクタを指定できるようにすべきである。
.
.SH 関連項目
\fBdpkg\-source\fP(1), \fBdpkg\-architecture\fP(1), \fBdpkg\-buildflags\fP(1),
\fBdpkg\-genchanges\fP(1), \fBfakeroot\fP(1), \fBgpg\fP(1).
.SH 翻訳者
高橋 基信 <monyo@monyo.com>.
喜瀬 浩 <kise@fuyuneko.jp>.
関戸 幸一 <sekido@mbox.kyoto-inet.or.jp>.
鍋谷 栄展 <nabe@debian.or.jp>.
倉澤 望 <nabetaro@debian.or.jp>.
石川 睦 <ishikawa@linux.or.jp>.
鵜飼 文敏 <ukai@debian.or.jp>.
中野 武雄 <nakano@apm.seikei.ac.jp>.
.SH 翻訳校正
Debian JP Documentation ML <debian-doc@debian.or.jp>.
