From 4535555ea3c9270f59d36c89191469d41fb3d297 Mon Sep 17 00:00:00 2001
From: Justin Maggard <jmaggard@netgear.com>
Date: Fri, 18 Mar 2016 15:00:56 -0700
Subject: [PATCH] wsdd2: Fix some more debug log levels.

---
 packages/wsdd2/llmnr.c | 2 +-
 packages/wsdd2/wsd.c   | 2 +-
 packages/wsdd2/wsdd.h  | 3 +--
 packages/wsdd2/wsdd2.c | 6 +++---
 4 files changed, 6 insertions(+), 7 deletions(-)

diff --git a/packages/wsdd2/llmnr.c b/packages/wsdd2/llmnr.c
index df50d6a..df29b30 100644
--- a/packages/wsdd2/llmnr.c
+++ b/packages/wsdd2/llmnr.c
@@ -292,7 +292,7 @@ static int llmnr_send_response(struct endpoint *ep,
 	 */
 	out = calloc(inlen + answer_len, 1);
 	if (out == NULL) {
-		DEBUG(1, L, "llmnr: no memory for output buffer");
+		DEBUG(0, L, "llmnr: no memory for output buffer");
 		return -1;
 	}
 
diff --git a/packages/wsdd2/wsd.c b/packages/wsdd2/wsd.c
index dd1faf6..1312145 100644
--- a/packages/wsdd2/wsd.c
+++ b/packages/wsdd2/wsd.c
@@ -140,7 +140,7 @@ static char *get_smbparm(struct endpoint *ep,
 		char buf[80];
 
 		if (!fgets(buf, sizeof buf, pp) || !buf[0]  || buf[0] == '\n') {
-			DEBUG(1, W, "cannot read %s from testparm", name);
+			DEBUG(0, W, "cannot read %s from testparm", name);
 			result = strdup(_default);
 		} else {/* Trim sapces. */
 			char *p;
diff --git a/packages/wsdd2/wsdd.h b/packages/wsdd2/wsdd.h
index af10ee5..03df247 100644
--- a/packages/wsdd2/wsdd.h
+++ b/packages/wsdd2/wsdd.h
@@ -52,9 +52,8 @@ extern int debug_L, debug_W;
 		if (debug_##y >= (x)) {	\
 			fprintf(stderr, __VA_ARGS__);	\
 			putc('\n', stderr);		\
-		}		\
-		if ((x) == 1)	\
 			syslog(LOG_USER|LOG_ERR, __VA_ARGS__);	\
+		}		\
 	} while (0)
 
 #ifndef HOST_NAME_MAX
diff --git a/packages/wsdd2/wsdd2.c b/packages/wsdd2/wsdd2.c
index 9d998d2..add5586 100644
--- a/packages/wsdd2/wsdd2.c
+++ b/packages/wsdd2/wsdd2.c
@@ -405,7 +405,7 @@ static int open_ep(struct endpoint **epp, struct service *sv,
 		ep->_errno = errno;
 		close(ep->sock);
 		ep->sock = -1;
-		DEBUG(1, W, "%s: %s: %s",
+		DEBUG(0, W, "%s: %s: %s",
 			ep->service->name, ep->errstr, strerror(ep->_errno));
 		return (ep->_errno == EADDRINUSE) ? 0 : -1;
 	}
@@ -509,7 +509,7 @@ static int netlink_recv(struct endpoint *ep)
 			nh->nlmsg_type == RTM_NEWLINK ||
 			nh->nlmsg_type == RTM_DELLINK) {
 			DEBUG(1, W,
-		"I/F address addtion/change/deletion detected.");
+		"I/F address addition/change/deletion detected.");
 			restart_service();
 			break;
 		}
@@ -521,7 +521,7 @@ static int netlink_recv(struct endpoint *ep)
 
 static void sighandler(int sig)
 {
-	DEBUG(1, W, "%s received.", strsignal(sig));
+	DEBUG(0, W, "%s received.", strsignal(sig));
 	restart = (sig == SIGHUP);
 }
 
-- 
1.9.1

