From: NIIBE Yutaka <gniibe@fsij.org>
Date: Fri, 7 Jul 2017 21:20:56 +0900
Subject: CVE-2017-7526: rsa: Allow different build directory.

* cipher/Makefile.am (AM_CPPFLAGS): Add mpi dirs.
* cipher/rsa.c: Change include file.

Signed-off-by: NIIBE Yutaka <gniibe@fsij.org>
---
 cipher/Makefile.am | 2 +-
 cipher/Makefile.in | 2 +-
 cipher/rsa.c       | 2 +-
 3 files changed, 3 insertions(+), 3 deletions(-)

diff --git a/cipher/Makefile.am b/cipher/Makefile.am
index a10af20..92ffe90 100644
--- a/cipher/Makefile.am
+++ b/cipher/Makefile.am
@@ -17,7 +17,7 @@
 # along with this program; if not, see <http://www.gnu.org/licenses/>.
 ## Process this file with automake to produce Makefile.in
 
-AM_CPPFLAGS = -I.. -I$(top_srcdir)/include -I$(top_srcdir)/intl
+AM_CPPFLAGS = -I.. -I$(top_srcdir)/include -I$(top_srcdir)/intl -I$(top_srcdir)/mpi -I../mpi
 
 if ! HAVE_DOSISH_SYSTEM
 AM_CPPFLAGS += -DGNUPG_LIBDIR="\"$(libdir)/@PACKAGE@\""
diff --git a/cipher/Makefile.in b/cipher/Makefile.in
index a2a3fd1..6238cbb 100644
--- a/cipher/Makefile.in
+++ b/cipher/Makefile.in
@@ -299,7 +299,7 @@ target_alias = @target_alias@
 top_build_prefix = @top_build_prefix@
 top_builddir = @top_builddir@
 top_srcdir = @top_srcdir@
-AM_CPPFLAGS = -I.. -I$(top_srcdir)/include -I$(top_srcdir)/intl \
+AM_CPPFLAGS = -I.. -I$(top_srcdir)/include -I$(top_srcdir)/intl -I$(top_srcdir)/mpi -I../mpi \
 	$(am__append_1)
 noinst_LIBRARIES = libcipher.a
 libcipher_a_SOURCES = cipher.c pubkey.c md.c dynload.c bithelp.h des.c \
diff --git a/cipher/rsa.c b/cipher/rsa.c
index 78a6f87..f454992 100644
--- a/cipher/rsa.c
+++ b/cipher/rsa.c
@@ -29,7 +29,7 @@
 #include <string.h>
 #include "util.h"
 #include "mpi.h"
-#include "../mpi/mpi-internal.h"
+#include "mpi-internal.h"
 #include "cipher.h"
 #include "rsa.h"
 
