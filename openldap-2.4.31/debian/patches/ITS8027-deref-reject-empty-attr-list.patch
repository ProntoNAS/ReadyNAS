commit c32e74763f77675b9e144126e375977ed6dc562c
Author: Howard Chu <hyc@openldap.org>
Date:   Mon Jan 19 22:25:53 2015 +0000

    ITS#8027 require non-empty AttributeList

Index: openldap/servers/slapd/overlays/deref.c
===================================================================
--- openldap.orig/servers/slapd/overlays/deref.c	2015-02-05 12:46:45.420064048 +0100
+++ openldap/servers/slapd/overlays/deref.c	2015-02-05 12:46:45.412060048 +0100
@@ -182,7 +182,8 @@
 		ber_len_t cnt = sizeof(struct berval);
 		ber_len_t off = 0;
 
-		if ( ber_scanf( ber, "{m{M}}", &derefAttr, &attributes, &cnt, off ) == LBER_ERROR )
+		if ( ber_scanf( ber, "{m{M}}", &derefAttr, &attributes, &cnt, off ) == LBER_ERROR
+			|| !cnt )
 		{
 			rs->sr_text = "Dereference control: derefSpec decoding error";
 			rs->sr_err = LDAP_PROTOCOL_ERROR;
