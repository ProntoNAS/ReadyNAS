Backport of:

From 1a321bfdb91defe3c4d9cca5651724ae167e5436 Mon Sep 17 00:00:00 2001
From: "deraadt@openbsd.org" <deraadt@openbsd.org>
Date: Wed, 15 Mar 2017 03:52:30 +0000
Subject: [PATCH] upstream commit

accidents happen to the best of us; ok djm

Upstream-ID: b7a9dbd71011ffde95e06f6945fe7197dedd1604
---
 ssh-agent.c | 3 ++-
 sshd.c      | 4 ++--
 2 files changed, 4 insertions(+), 3 deletions(-)

Index: openssh-6.6p1/ssh-agent.c
===================================================================
--- openssh-6.6p1.orig/ssh-agent.c	2018-01-18 08:40:55.313385371 -0500
+++ openssh-6.6p1/ssh-agent.c	2018-01-18 08:40:55.309385363 -0500
@@ -703,6 +703,7 @@ process_remove_smartcard_key(SocketEntry
 	else
 		error("process_remove_smartcard_key:"
 		    " pkcs11_del_provider failed");
+send:
 	free(provider);
 	buffer_put_int(&e->output, 1);
 	buffer_put_char(&e->output,
