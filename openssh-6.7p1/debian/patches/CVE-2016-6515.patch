Description: <short summary of the patch>
 Skip passwords longer than 1k in length so clients can't
 easily DoS sshd by sending very long passwords, causing it to spend CPU
 hashing them. 
 .
 openssh (1:6.0p1-4+deb7u6) wheezy-security; urgency=high
 .
   * Non-maintainer upload by the Long Tem Security Team.
   * Limit password length to avoid DOS attack (CVE-2016-6515). Closes:
     #833823.
Author: Ola Lundqvist <opal@debian.og>
Bug-Debian: http://bugs.debian.org/833823
Origin: upstream, https://anongit.mindrot.org/openssh.git/patch/?id=fcd135c9df440bcd2d5870405ad3311743d78d97
Forwarded: not-needed
Reviewed-By: Ola Lundqvist <opal@debian.org>
Last-Update: 2016-08-09
Origin: debian, openssh_1:6.0p1-4+deb7u7
Reviewed-By: Santiago R.R. <santiagorr@riseup.net>

--- openssh-6.0p1.orig/auth-passwd.c
+++ openssh-6.0p1/auth-passwd.c
@@ -65,6 +65,8 @@ extern login_cap_t *lc;
 #define DAY		(24L * 60 * 60) /* 1 day in seconds */
 #define TWO_WEEKS	(2L * 7 * DAY)	/* 2 weeks in seconds */
 
+#define MAX_PASSWORD_LEN	1024
+
 void
 disable_forwarding(void)
 {
@@ -86,6 +88,9 @@ auth_password(Authctxt *authctxt, const
 	static int expire_checked = 0;
 #endif
 
+	if (strlen(password) > MAX_PASSWORD_LEN)
+		return 0;
+
 #ifndef HAVE_CYGWIN
 	if (pw->pw_uid == 0 && options.permit_root_login != PERMIT_YES)
 		ok = 0;
