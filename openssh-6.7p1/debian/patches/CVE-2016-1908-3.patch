From 5658ef2501e785fbbdf5de2dc33b1ff7a4dca73a Mon Sep 17 00:00:00 2001
From: "millert@openbsd.org" <millert@openbsd.org>
Date: Mon, 1 Feb 2016 21:18:17 +0000
Subject: [PATCH] upstream commit

Origin: upstream, 5658ef2501e785fbbdf5de2dc33b1ff7a4dca73a 
Bug-Debian: https://bugs.debian.org/908652
Reviewed-by: Santiago R.R. <santiagorr@riseup.net>

Avoid ugly "DISPLAY "(null)" invalid; disabling X11
 forwarding" message when DISPLAY is not set.  This could also result in a
 crash on systems with a printf that doesn't handle NULL.  OK djm@

Upstream-ID: 20ee0cfbda678a247264c20ed75362042b90b412
---
 clientloop.c | 7 ++++---
 1 file changed, 4 insertions(+), 3 deletions(-)

Index: openssh/clientloop.c
===================================================================
--- openssh.orig/clientloop.c
+++ openssh/clientloop.c
@@ -324,8 +324,9 @@ client_x11_get_proto(const char *display
 	proto[0] = data[0] = xauthfile[0] = xauthdir[0] = '\0';
 
 	if (!client_x11_display_valid(display)) {
-		logit("DISPLAY \"%s\" invalid; disabling X11 forwarding",
-		    display);
+		if (display != NULL)
+			logit("DISPLAY \"%s\" invalid; disabling X11 forwarding",
+			    display);
 		return -1;
 	}
 	if (xauth_path != NULL && stat(xauth_path, &st) == -1) {
