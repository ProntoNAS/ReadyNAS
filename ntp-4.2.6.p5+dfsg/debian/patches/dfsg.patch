From: Kurt Roeckx <kurt@roeckx.be>
Subject: Make the package compile with non dfsg compatible parts removed.
Forwarded: not-needed
Bug-Debian: http://bugs.debian.org/328200

Index: ntp-4.2.6.p3+dfsg/adjtimed/adjtimed.c
===================================================================
--- ntp-4.2.6.p3+dfsg.orig/adjtimed/adjtimed.c	2004-02-25 05:57:37.000000000 +0000
+++ ntp-4.2.6.p3+dfsg/adjtimed/adjtimed.c	2011-06-03 14:54:38.000000000 +0000
@@ -41,8 +41,6 @@
 #include "ntp_syslog.h"
 #include "ntp_stdlib.h"
 
-#include "adjtime.h"
-
 double atof (const char *);
 
 int InitClockRate (void);
Index: ntp-4.2.6.p3+dfsg/libntp/Makefile.am
===================================================================
--- ntp-4.2.6.p3+dfsg.orig/libntp/Makefile.am	2010-12-25 09:40:36.000000000 +0000
+++ ntp-4.2.6.p3+dfsg/libntp/Makefile.am	2011-06-03 14:54:38.000000000 +0000
@@ -7,7 +7,6 @@
 EXTRA_LIBRARIES = libntpsim.a
 libntp_a_SRCS =						\
 	a_md5encrypt.c					\
-	adjtime.c					\
 	atoint.c					\
 	atolfp.c					\
 	atouint.c					\
Index: ntp-4.2.6.p3+dfsg/include/Makefile.am
===================================================================
--- ntp-4.2.6.p3+dfsg.orig/include/Makefile.am	2010-12-25 09:40:36.000000000 +0000
+++ ntp-4.2.6.p3+dfsg/include/Makefile.am	2011-06-03 14:54:38.000000000 +0000
@@ -6,7 +6,6 @@
 SUBDIRS = isc
 
 noinst_HEADERS =	\
-	adjtime.h	\
 	audio.h		\
 	ascii.h		\
 	audio.h		\
@@ -64,9 +63,6 @@
 	recvbuff.h	\
 	refclock_atom.h	\
 	ssl_applink.c	\
-	timepps-SCO.h	\
-	timepps-Solaris.h	\
-	timepps-SunOS.h	\
 	trimble.h	\
 	$(NULL)
 
Index: ntp-4.2.6.p3+dfsg/Makefile.am
===================================================================
--- ntp-4.2.6.p3+dfsg.orig/Makefile.am	2010-12-25 09:40:35.000000000 +0000
+++ ntp-4.2.6.p3+dfsg/Makefile.am	2011-06-03 14:55:06.000000000 +0000
@@ -8,7 +8,6 @@
 SUBDIRS += 		\
 	scripts 	\
 	include 	\
-	ElectricFence	\
 	libntp		\
 	sntp		\
 	libparse	\
@@ -27,7 +26,6 @@
 DIST_SUBDIRS =		\
 	scripts		\
 	include		\
-	ElectricFence	\
 	libntp		\
 	libparse	\
 	sntp		\
Index: ntp-4.2.6.p3+dfsg/configure.ac
===================================================================
--- ntp-4.2.6.p3+dfsg.orig/configure.ac	2011-01-04 01:57:27.000000000 +0000
+++ ntp-4.2.6.p3+dfsg/configure.ac	2011-06-03 14:58:40.000000000 +0000
@@ -3964,26 +3964,26 @@
     AC_MSG_ERROR([That's a parse clock and this system doesn't support it!])
 esac
 
-AC_MSG_CHECKING([WHARTON 400A Series clock])
-AC_ARG_ENABLE(
-    [WHARTON],
-    [AS_HELP_STRING(
-	[--enable-WHARTON],
-	[s WHARTON 400A Series clock]
-    )],
-    [ntp_ok=$enableval],
-    [ntp_ok=$ntp_eapc]
-)
-if test "$ntp_ok" = "yes"; then
-    ntp_libparse=yes
-    ntp_refclock=yes
-    AC_DEFINE([CLOCK_WHARTON_400A], [1], [WHARTON 400A Series clock])
-fi
-AC_MSG_RESULT([$ntp_ok])
-case "$ntp_ok$ntp_canparse" in
- yesno)
-    AC_MSG_ERROR([That's a parse clock and this system doesn't support it!])
-esac
+dnl AC_MSG_CHECKING([WHARTON 400A Series clock])
+dnl AC_ARG_ENABLE(
+dnl     [WHARTON],
+dnl     [AS_HELP_STRING(
+dnl 	[--enable-WHARTON],
+dnl 	[s WHARTON 400A Series clock]
+dnl     )],
+dnl     [ntp_ok=$enableval],
+dnl     [ntp_ok=$ntp_eapc]
+dnl )
+dnl if test "$ntp_ok" = "yes"; then
+dnl     ntp_libparse=yes
+dnl     ntp_refclock=yes
+dnl     AC_DEFINE([CLOCK_WHARTON_400A], [1], [WHARTON 400A Series clock])
+dnl fi
+dnl AC_MSG_RESULT([$ntp_ok])
+dnl case "$ntp_ok$ntp_canparse" in
+dnl  yesno)
+dnl     AC_MSG_ERROR([That's a parse clock and this system doesn't support it!])
+dnl esac
 
 AC_MSG_CHECKING([VARITEXT clock])
 AC_ARG_ENABLE(
@@ -5595,7 +5595,6 @@
     [Default location of crypto key info])
 
 AC_CONFIG_FILES([Makefile])
-AC_CONFIG_FILES([ElectricFence/Makefile])
 AC_CONFIG_FILES([adjtimed/Makefile])
 AC_CONFIG_FILES([clockstuff/Makefile])
 AC_CONFIG_FILES([include/Makefile])
@@ -5620,7 +5619,6 @@
 AC_CONFIG_FILES([scripts/ntp-wait],	[chmod +x scripts/ntp-wait])
 AC_CONFIG_FILES([scripts/ntpsweep],	[chmod +x scripts/ntpsweep])
 AC_CONFIG_FILES([scripts/ntptrace],	[chmod +x scripts/ntptrace])
-AC_CONFIG_FILES([scripts/ntpver],	[chmod +x scripts/ntpver])
 AC_CONFIG_FILES([scripts/plot_summary],	[chmod +x scripts/plot_summary])
 AC_CONFIG_FILES([scripts/summary],	[chmod +x scripts/summary])
 AC_CONFIG_FILES([util/Makefile])
Index: ntp-4.2.6.p3+dfsg/scripts/Makefile.am
===================================================================
--- ntp-4.2.6.p3+dfsg.orig/scripts/Makefile.am	2011-01-04 01:57:27.000000000 +0000
+++ ntp-4.2.6.p3+dfsg/scripts/Makefile.am	2011-06-03 14:54:38.000000000 +0000
@@ -13,7 +13,6 @@
 	html2man		\
 	mkver			\
 	ntpsweep		\
-	ntpver			\
 	plot_summary		\
 	summary			\
 	$(NULL)
Index: ntp-4.2.6.p3+dfsg/libparse/Makefile.am
===================================================================
--- ntp-4.2.6.p3+dfsg.orig/libparse/Makefile.am	2009-12-20 05:21:43.000000000 +0000
+++ ntp-4.2.6.p3+dfsg/libparse/Makefile.am	2011-06-03 14:54:38.000000000 +0000
@@ -21,7 +21,6 @@
 		     clk_rcc8000.c \
 		     clk_hopf6021.c \
 		     clk_computime.c \
-		     clk_wharton.c \
 		     clk_varitext.c \
 		     data_mbg.c \
 		     info_trimble.c \
@@ -46,7 +45,6 @@
 	kclk_trimtaip.o		\
 	kclk_trimtsip.o		\
 	kclk_varitext.o		\
-	kclk_wharton.o		\
 	kbinio.o		\
 	kieee754io.o		\
 	kmfp_mul.o		\
