#! /bin/sh /usr/share/dpatch/dpatch-run

@DPATCH@
diff -urNad apr-util-1.2.12+dfsg~/strmatch/apr_strmatch.c apr-util-1.2.12+dfsg/strmatch/apr_strmatch.c
--- apr-util-1.2.12+dfsg~/strmatch/apr_strmatch.c	2009-06-02 18:58:49.000000000 +0200
+++ apr-util-1.2.12+dfsg/strmatch/apr_strmatch.c	2009-06-03 23:03:55.650337096 +0200
@@ -74,7 +74,7 @@
             }
             s_tmp--;
         }
-        s_next += shift[apr_tolower(*s_next)];
+        s_next += shift[(unsigned char)apr_tolower(*s_next)];
     }
     return NULL;
 }
@@ -103,13 +103,13 @@
     if (case_sensitive) {
         pattern->compare = match_boyer_moore_horspool;
         for (i = 0; i < pattern->length - 1; i++) {
-            shift[(int)s[i]] = pattern->length - i - 1;
+            shift[(unsigned char)s[i]] = pattern->length - i - 1;
         }
     }
     else {
         pattern->compare = match_boyer_moore_horspool_nocase;
         for (i = 0; i < pattern->length - 1; i++) {
-            shift[apr_tolower(s[i])] = pattern->length - i - 1;
+            shift[(unsigned char)apr_tolower(s[i])] = pattern->length - i - 1;
         }
     }
     pattern->context = shift;
