X-Git-Url: http://git.savannah.gnu.org/gitweb/?p=libtasn1.git;a=blobdiff_plain;f=lib%2Fparser_aux.c;h=976ab38f1863845c03ed5730d91ebe0113348f79;hp=b4a7370b9b7516239fd471c818c6e276423f4e6f;hb=5520704d075802df25ce4ffccc010ba1641bd484;hpb=8f4b3ef8df0e337b4d1430cf50e4f3c3ef577353

Index: libtasn1-6-4.2/lib/parser_aux.c
===================================================================
--- libtasn1-6-4.2.orig/lib/parser_aux.c	2017-05-23 19:24:05.445494756 +0200
+++ libtasn1-6-4.2/lib/parser_aux.c	2017-05-23 19:24:05.441494517 +0200
@@ -120,6 +120,9 @@
       if (n_end)
 	{
 	  nsize = n_end - n_start;
+	  if (nsize >= sizeof(n))
+		return NULL;
+
 	  memcpy (n, n_start, nsize);
 	  n[nsize] = 0;
 	  n_start = n_end;
@@ -158,6 +161,9 @@
       if (n_end)
 	{
 	  nsize = n_end - n_start;
+	  if (nsize >= sizeof(n))
+		return NULL;
+
 	  memcpy (n, n_start, nsize);
 	  n[nsize] = 0;
 	  n_start = n_end;
