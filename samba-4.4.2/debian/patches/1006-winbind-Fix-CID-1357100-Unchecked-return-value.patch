From f10cb3d3dee843068b579ee7a27cf6e7f4fc99a1 Mon Sep 17 00:00:00 2001
From: Volker Lendecke <vl@samba.org>
Date: Tue, 22 Mar 2016 11:24:23 +0100
Subject: [PATCH 1006/1096] winbind: Fix CID 1357100 Unchecked return value
MIME-Version: 1.0
Content-Type: text/plain; charset=UTF-8
Content-Transfer-Encoding: 8bit

Signed-off-by: Volker Lendecke <vl@samba.org>
Reviewed-by: Ralph Boehme <slow@samba.org>

Autobuild-User(master): Ralph BÃ¶hme <slow@samba.org>
Autobuild-Date(master): Tue Mar 22 15:49:14 CET 2016 on sn-devel-144

BUG: https://bugzilla.samba.org/show_bug.cgi?id=11786
(cherry picked from commit 26f5b40d947a4351c944034f7093c5c92c512753)
---
 source3/winbindd/idmap.c | 6 +++++-
 1 file changed, 5 insertions(+), 1 deletion(-)

diff --git a/source3/winbindd/idmap.c b/source3/winbindd/idmap.c
index faf0df2..7eb7e58 100644
--- a/source3/winbindd/idmap.c
+++ b/source3/winbindd/idmap.c
@@ -126,8 +126,12 @@ bool domain_has_idmap_config(const char *domname)
 	char *config_option;
 	const char *range = NULL;
 	const char *backend = NULL;
+	bool ok;
 
-	idmap_init();
+	ok = idmap_init();
+	if (!ok) {
+		return false;
+	}
 
 	for (i=0; i<num_domains; i++) {
 		if (strequal(idmap_domains[i]->name, domname)) {
-- 
2.9.0

