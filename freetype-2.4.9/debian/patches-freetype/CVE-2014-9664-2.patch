From dd89710f0f643eb0f99a3830e0712d26c7642acd Mon Sep 17 00:00:00 2001
From: Werner Lemberg <wl@gnu.org>
Date: Fri, 21 Nov 2014 21:19:28 +0000
Subject: [type1, type42] Fix Savannah bug #43655.

* src/type1/t1load.c (parse_charstrings), src/type42/t42parse.c
(t42_parse_charstrings): Fix boundary testing.
---
Index: freetype-2.4.8/src/type1/t1load.c
===================================================================
--- freetype-2.4.8.orig/src/type1/t1load.c	2015-02-24 10:04:02.782532741 -0500
+++ freetype-2.4.8/src/type1/t1load.c	2015-02-24 10:04:02.778532710 -0500
@@ -1586,7 +1586,7 @@
         FT_PtrDist  len;
 
 
-        if ( cur + 1 >= limit )
+        if ( cur + 2 >= limit )
         {
           error = T1_Err_Invalid_File_Format;
           goto Fail;
Index: freetype-2.4.8/src/type42/t42parse.c
===================================================================
--- freetype-2.4.8.orig/src/type42/t42parse.c	2015-02-24 10:04:02.782532741 -0500
+++ freetype-2.4.8/src/type42/t42parse.c	2015-02-24 10:04:02.778532710 -0500
@@ -832,7 +832,7 @@
         FT_PtrDist  len;
 
 
-        if ( cur + 1 >= limit )
+        if ( cur + 2 >= limit )
         {
           FT_ERROR(( "t42_parse_charstrings: out of bounds\n" ));
           error = T42_Err_Invalid_File_Format;
