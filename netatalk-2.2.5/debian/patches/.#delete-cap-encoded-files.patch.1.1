--- netatalk-2-2-1-p7/etc/afpd/filedir.c	2011-11-03 07:36:57.000000000 -0700
+++ netatalk-2-2-1-p7-fixed/etc/afpd/filedir.c	2011-12-14 14:12:00.201738649 -0800
@@ -623,6 +623,24 @@ int afp_delete(AFPObj *obj, char *ibuf, 
          */
         if (s_path->st_valid && s_path->st_errno == ENOENT) {
             rc = AFPERR_NOOBJ;
+            /* Check for :2e */
+            if (*upath == '.') {
+                char convpath[MAXPATHLEN];
+                snprintf(convpath, sizeof(convpath), ":2%s", upath);
+                convpath[2] = 'e';
+                s_path->u_name = upath = convpath;
+                if (of_stat(vol, s_path) == 0 && !S_ISDIR(s_path->st.st_mode)) {
+                    LOG(log_debug, logtype_afpd, "Delete failed on missing dot file,"
+                                                 "deleting :2e instead (%s)", upath);
+                    if ((rc = deletefile(vol, -1, upath, 1)) == AFP_OK)
+                        fce_register_delete_file( s_path );
+                    struct dir *cachedfile;
+                    if ((cachedfile = dircache_search_by_name(vol, dir, upath, strlen(upath)))) {
+                        dircache_remove(vol, cachedfile, DIRCACHE | DIDNAME_INDEX | QUEUE_INDEX);
+                        dir_free(cachedfile);
+                    }
+                }
+            }
         } else {
             if ((rc = deletefile(vol, -1, upath, 1)) == AFP_OK) {
 				fce_register_delete_file( s_path );
