From afa80cb2b457bf8d64f775bed307588610476c41 Mon Sep 17 00:00:00 2001
From: Michael R Sweet <michaelrsweet@gmail.com>
Date: Tue, 3 Jan 2017 13:52:47 -0500
Subject: [PATCH] Don't treat "localhost.localdomain" as an allowed replacement
 for localhost, since it isn't.

Fixes: CVE-2017-18190
---
 scheduler/client.c | 3 ---
 1 file changed, 3 deletions(-)

--- a/scheduler/client.c
+++ b/scheduler/client.c
@@ -4220,9 +4220,6 @@
 
     return (!_cups_strcasecmp(con->clientname, "localhost") ||
 	    !_cups_strcasecmp(con->clientname, "localhost.") ||
-#ifdef __linux
-	    !_cups_strcasecmp(con->clientname, "localhost.localdomain") ||
-#endif /* __linux */
             !strcmp(con->clientname, "127.0.0.1") ||
 	    !strcmp(con->clientname, "[::1]"));
   }
