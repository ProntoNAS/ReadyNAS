Description: Fix CVE issues:
 CVE-2020-3898 - cups/ppd.c, ppdc/ppdc-source.cxx
   The `ppdOpen` function did not handle invalid UI
   constraint.  `ppdcSource::get_resolution` function did not handle
   invalid resolution strings.
 CVE-2019-8842 - cups/ipp.c: ippReadIO
   The `ippReadIO` function may under-read an extension
   field.
Author: Utkarsh Gupta <utkarsh@debian.org>

--- a/cups/ipp.c
+++ b/cups/ipp.c
@@ -3198,7 +3198,7 @@
             * Read 32-bit "extension" tag...
             */
 
-	    if ((*cb)(src, buffer, 4) < 1)
+	    if ((*cb)(src, buffer, 4) < 4)
 	    {
 	      DEBUG_puts("1ippReadIO: Callback returned EOF/error");
 	      _cupsBufferRelease((char *)buffer);
--- a/cups/ppd.c
+++ b/cups/ppd.c
@@ -1715,8 +1715,7 @@
                      constraint->choice1, constraint->option2,
 		     constraint->choice2))
       {
-        case 0 : /* Error */
-	case 1 : /* Error */
+        default : /* Error */
 	    cg->ppd_status = PPD_BAD_UI_CONSTRAINTS;
 	    goto error;
 
--- a/ppdc/ppdc-source.cxx
+++ b/ppdc/ppdc-source.cxx
@@ -1791,15 +1791,17 @@
 
   switch (sscanf(name, "%dx%d", &xdpi, &ydpi))
   {
-    case 0 :
-        _cupsLangPrintf(stderr,
-	                _("ppdc: Bad resolution name \"%s\" on line %d of "
-			  "%s."), name, fp->line, fp->filename);
-        break;
     case 1 :
         ydpi = xdpi;
-	break;
-  }
+        break;
+    case 2 :
+        break;
+    default :
+        _cupsLangPrintf(stderr,
+                  _("ppdc: Bad resolution name \"%s\" on line %d of "
+        "%s."), name, fp->line, fp->filename);
+        break;
+}
 
   // Create the necessary PS commands...
   snprintf(command, sizeof(command),
