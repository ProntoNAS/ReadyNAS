<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE refentry PUBLIC "-//OASIS//DTD DocBook XML V4.2//EN" "http://www.oasis-open.org/docbook/xml/4.2/docbookx.dtd">
<refentry id="testparm.1">

<refmeta>
	<refentrytitle>testparm</refentrytitle>
	<manvolnum>1</manvolnum>
	<refmiscinfo class="source">Samba</refmiscinfo>
	<refmiscinfo class="manual">User Commands</refmiscinfo>
	<refmiscinfo class="version">4.8.0</refmiscinfo>
</refmeta>


<refnamediv>
	<refname>testparm</refname>
	<refpurpose>check an smb.conf configuration file for 
	internal correctness</refpurpose>
</refnamediv>

<refsynopsisdiv>
	<cmdsynopsis sepchar=" ">
		<literal>testparm</literal>
		<arg choice="opt" rep="norepeat">-s|--suppress-prompt</arg>
		<arg choice="opt" rep="norepeat">--help</arg>
		<arg choice="opt" rep="norepeat">-v|--verbose</arg>
		<arg choice="req" rep="norepeat">config filename</arg>
		<arg choice="opt" rep="norepeat">hostname hostIP</arg>
	</cmdsynopsis>
</refsynopsisdiv>

<refsect1>
	<title>DESCRIPTION</title>

	<para>This tool is part of the <citerefentry><refentrytitle>samba</refentrytitle>
	<manvolnum>7</manvolnum></citerefentry> suite.</para>

	<para><literal>testparm</literal> is a very simple test program 
	to check an <citerefentry><refentrytitle>smbd</refentrytitle>
	<manvolnum>8</manvolnum></citerefentry> configuration file for 
	internal correctness. If this program reports no problems, you 
	can use the configuration file with confidence that <literal>smbd
	</literal> will successfully load the configuration file.</para>


	<para>Note that this is <emphasis>NOT</emphasis> a guarantee that 
	the services specified in the configuration file will be 
	available or will operate as expected. </para>

	<para>If the optional host name and host IP address are 
	specified on the command line, this test program will run through 
	the service entries reporting whether the specified host
	has access to each service. </para>

	<para>If <literal>testparm</literal> finds an error in the <filename moreinfo="none">
	smb.conf</filename> file it returns an exit code of 1 to the calling 
	program, else it returns an exit code of 0. This allows shell scripts 
	to test the output from <literal>testparm</literal>.</para>
</refsect1>

<refsect1>
	<title>OPTIONS</title>

	<variablelist>
		<varlistentry>
		<term>-s|--suppress-prompt</term>
		<listitem><para>Without this option, <literal>testparm</literal> 
		will prompt for a carriage return after printing the service 
		names and before dumping the service definitions.</para></listitem>
		</varlistentry>

		
<varlistentry>
<term>-V|--version</term>
<listitem><para>Prints the program version number.
</para></listitem>
</varlistentry>
		
<varlistentry>
<term>--option=&lt;name&gt;=&lt;value&gt;</term>
<listitem><para>Set the
<citerefentry><refentrytitle>smb.conf</refentrytitle>
<manvolnum>5</manvolnum></citerefentry>
option "&lt;name&gt;" to value "&lt;value&gt;" from the command line.
This overrides compiled-in defaults and options read from the configuration
file.
</para></listitem>
</varlistentry>
		

<varlistentry>
<term>-?|--help</term>
<listitem><para>Print a summary of command line options.
</para></listitem>
</varlistentry>


<varlistentry>
<term>--usage</term>
<listitem><para>Display brief usage message.
</para></listitem>
</varlistentry>


		
<varlistentry>
<term>-d|--debuglevel=level</term>
<listitem>
<para><replaceable>level</replaceable> is an integer 
from 0 to 10. The default value if this parameter is 
not specified is 1.</para>

<para>The higher this value, the more detail will be 
logged to the log files about the activities of the 
server. At level 0, only critical errors and serious 
warnings will be logged. Level 1 is a reasonable level for
day-to-day running - it generates a small amount of 
information about operations carried out.</para>

<para>Levels above 1 will generate considerable 
amounts of log data, and should only be used when 
investigating a problem. Levels above 3 are designed for 
use only by developers and generate HUGE amounts of log
data, most of which is extremely cryptic.</para>

<para>Note that specifying this parameter here will 
override the <link xmlns:xlink="http://www.w3.org/1999/xlink" linkend="LOGLEVEL" xlink:href="smb.conf.5.html#LOGLEVEL">log level</link> parameter
in the <filename moreinfo="none">smb.conf</filename> file.</para>
</listitem>
</varlistentry>

		<varlistentry>
		<term>-v|--verbose</term>
		<listitem><para>If this option is specified, testparm 
		will also output all options that were not used in <citerefentry>
		<refentrytitle>smb.conf</refentrytitle><manvolnum>5</manvolnum>
		</citerefentry> and are thus set to their defaults.</para></listitem>
		</varlistentry>

		<varlistentry>
		<term>--parameter-name parametername</term>
		<listitem><para>
		Dumps the named parameter.  If no section-name is set the view
		is limited by default to the global section.

		It is also possible to dump a parametrical option.  Therefore
		the option has to be separated by a colon from the
		parametername.
		</para></listitem>
		</varlistentry>

		<varlistentry>
		<term>--section-name sectionname</term>
		<listitem><para>
		Dumps the named section.
		</para></listitem>
		</varlistentry>

		<varlistentry>
		<term>--show-all-parameters</term>
		<listitem><para>
				Show the parameters, type, possible values.
		</para></listitem>
		</varlistentry>

		<varlistentry>
		<term>-l|--skip-logic-checks</term>
		<listitem><para>
				Skip the global checks.
		</para></listitem>
		</varlistentry>

		<varlistentry>
		<term>configfilename</term>
		<listitem><para>This is the name of the configuration file 
		to check. If this parameter is not present then the 
		default <citerefentry><refentrytitle>smb.conf</refentrytitle><manvolnum>5</manvolnum>
		</citerefentry> file will be checked. 	
		</para></listitem>
		</varlistentry>


		<varlistentry>
		<term>hostname</term>
		<listitem><para>If this parameter and the following are 
		specified, then <literal>testparm</literal> will examine the <parameter moreinfo="none">hosts
		allow</parameter> and <parameter moreinfo="none">hosts deny</parameter> 
		parameters in the <citerefentry>
		<refentrytitle>smb.conf</refentrytitle><manvolnum>5</manvolnum>
		</citerefentry> file to 
		determine if the hostname with this IP address would be
		allowed access to the <literal>smbd</literal> server.  If 
		this parameter is supplied, the hostIP parameter must also
		be supplied.</para></listitem>
		</varlistentry>


		<varlistentry>
		<term>hostIP</term>
		<listitem><para>This is the IP address of the host specified 
		in the previous parameter.  This address must be supplied 
		if the hostname parameter is supplied. </para></listitem>
		</varlistentry>
	</variablelist>
</refsect1>

<refsect1>
	<title>FILES</title>

	<variablelist>
		<varlistentry>
		<term><citerefentry><refentrytitle>smb.conf</refentrytitle><manvolnum>5</manvolnum>
		</citerefentry></term>
		<listitem><para>This is usually the name of the configuration 
		file used by <citerefentry><refentrytitle>smbd</refentrytitle><manvolnum>8</manvolnum>
		</citerefentry>. 
		</para></listitem>
		</varlistentry>
	</variablelist>
</refsect1>

<refsect1>
	<title>DIAGNOSTICS</title>

	<para>The program will issue a message saying whether the 
	configuration file loaded OK or not. This message may be preceded by 
	errors and warnings if the file did not load. If the file was 
	loaded OK, the program then dumps all known service details 
	to stdout. </para>
</refsect1>


<refsect1>
	<title>VERSION</title>

	<para>This man page is part of version 4.8.0 of
	the Samba suite.</para>
</refsect1>

<refsect1>
	<title>SEE ALSO</title>
	<para><citerefentry>
		<refentrytitle>smb.conf</refentrytitle><manvolnum>5</manvolnum>
		</citerefentry>, <citerefentry>
		<refentrytitle>smbd</refentrytitle><manvolnum>8</manvolnum>
		</citerefentry></para>
</refsect1>

<refsect1>
	<title>AUTHOR</title>
	
	<para>The original Samba software and related utilities 
	were created by Andrew Tridgell. Samba is now developed
	by the Samba Team as an Open Source project similar 
	to the way the Linux kernel is developed.</para>
</refsect1>

</refentry>
