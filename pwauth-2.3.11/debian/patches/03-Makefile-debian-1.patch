Makefile fixes

Author: Hai Zaar <haizaar@haizaar.com>

--- a/Makefile
+++ b/Makefile
@@ -7,14 +7,11 @@
 
 # Settings for author's system (Redhat 6.1)
 CC=gcc
-LIB= -lcrypt
-LOCALFLAGS= -g 
+LIB= -lpam
+LOCALFLAGS:= -g $(CFLAGS) $(CPPFLAGS)
 
-# For PAM on Redhat Linux
-# LIB=-lpam -ldl
-
-# For PAM on Solaris or OS X
-# LIB=-lpam
+prefix=/usr
+sbindir=$(prefix)/sbin
 
 # -------------------- No User Servicable Parts Below -----------------------
 
@@ -25,16 +22,19 @@
 
 .PHONY: clean distclean
 
+programs = pwauth checkfaillog unixgroup
+all: $(programs)
+
 CFLAGS= $(LOCALFLAGS)
 
 pwauth: main.o auth_aix.o auth_bsd.o auth_hpux.o auth_mdw.o auth_openbsd.o \
 	auth_pam.o auth_sun.o fail_log.o lastlog.o nologin.o snooze.o
-	$(CC) -o pwauth $(CFLAGS) main.o auth_aix.o auth_bsd.o auth_hpux.o \
+	$(CC) -o pwauth $(CFLAGS) $(LDFLAGS) main.o auth_aix.o auth_bsd.o auth_hpux.o \
 		auth_mdw.o auth_openbsd.o auth_pam.o auth_sun.o fail_log.o \
 		lastlog.o nologin.o snooze.o $(LIB)
 
 checkfaillog: checkfaillog.o fail_check.o
-	$(CC) -o checkfaillog $(CFLAGS) checkfaillog.o fail_check.o $(LIB)
+	$(CC) -o checkfaillog $(CFLAGS) $(LDFLAGS) checkfaillog.o fail_check.o $(LIB)
 
 main.o: main.c config.h pwauth.h fail_log.h
 auth_aix.o: auth_aix.c config.h pwauth.h
@@ -53,10 +53,14 @@
 
 
 clean:
-	rm -f *.o
+	$(MAKE) distclean
 
 distclean:
 	rm -f *.o pwauth checkfaillog
 
 pwauth.tar: $(TAR)
 	tar cvf pwauth.tar $(TAR)
+
+install:
+	mkdir -p $(DESTDIR)$(sbindir)
+	install $(programs) $(DESTDIR)$(sbindir)
