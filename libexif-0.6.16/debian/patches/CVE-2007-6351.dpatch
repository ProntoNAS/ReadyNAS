#! /bin/sh /usr/share/dpatch/dpatch-run
## CVE-2007-6351.dpatch by Nico Golde <nion@debian.org>
##
## All lines beginning with `## DP:' are a description of the patch.
## DP: No description.

@DPATCH@
diff -urNad libexif-0.6.16~/libexif/exif-loader.c libexif-0.6.16/libexif/exif-loader.c
--- libexif-0.6.16~/libexif/exif-loader.c	2006-10-03 21:41:36.000000000 +0200
+++ libexif-0.6.16/libexif/exif-loader.c	2007-12-21 17:12:36.000000000 +0100
@@ -176,6 +176,9 @@
 		break;
 	}
 
+	if(!len)
+		return 1;
+
 	exif_log (eld->log, EXIF_LOG_CODE_DEBUG, "ExifLoader",
 		  "Scanning %i byte(s) of data...", len);
 
