Index: exiv2-0.24/src/psdimage.cpp
===================================================================
--- exiv2-0.24.orig/src/psdimage.cpp	2019-02-26 13:12:16.479783547 +0100
+++ exiv2-0.24/src/psdimage.cpp	2019-02-26 13:12:16.467783547 +0100
@@ -44,7 +44,9 @@
 #include "basicio.hpp"
 #include "error.hpp"
 #include "futils.hpp"
+
 #include "safe_op.hpp"
+#include "enforce.hpp"
 
 // + standard includes
 #include <string>
@@ -208,6 +210,8 @@
             throw Error(3, "Photoshop");
         }
         uint32_t resourcesLength = getULong(buf, bigEndian);
+        enforce(resourcesLength < io_->size(), 33);
+
         while (resourcesLength > 0)
         {
             if (io_->read(buf, 8) != 8)
