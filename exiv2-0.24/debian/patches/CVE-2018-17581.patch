Index: exiv2-0.24/src/crwimage.cpp
===================================================================
--- exiv2-0.24.orig/src/crwimage.cpp	2019-02-25 15:51:30.808822047 +0100
+++ exiv2-0.24/src/crwimage.cpp	2019-02-25 15:54:49.060819368 +0100
@@ -456,6 +456,8 @@
                                       uint32_t    size,
                                       ByteOrder   byteOrder)
     {
+        if (size < 4)
+            throw Error(33);
         uint32_t o = getULong(pData + size - 4, byteOrder);
         if (o + 2 > size) throw Error(33);
         uint16_t count = getUShort(pData + o, byteOrder);
@@ -464,8 +466,10 @@
                   <<", " << count << " entries \n";
 #endif
         o += 2;
+        if ( (o + (count * 10)) > size )
+            throw Error(33);
+
         for (uint16_t i = 0; i < count; ++i) {
-            if (o + 10 > size) throw Error(33);
             uint16_t tag = getUShort(pData + o, byteOrder);
             CiffComponent::AutoPtr m;
             switch (CiffComponent::typeId(tag)) {
