From c8bdecfa7ca48b30df49015c7b59ee963fae0473 Mon Sep 17 00:00:00 2001
From: Justin Maggard <jmaggard@netgear.com>
Date: Wed, 16 Sep 2015 13:22:00 -0700
Subject: [PATCH 5/9] btrfs: improve error logging

---
 snapper/AppUtil.cc | 3 +--
 snapper/File.cc    | 2 +-
 2 files changed, 2 insertions(+), 3 deletions(-)

diff --git a/snapper/AppUtil.cc b/snapper/AppUtil.cc
index 9eb17d3..8d88eaa 100644
--- a/snapper/AppUtil.cc
+++ b/snapper/AppUtil.cc
@@ -80,8 +80,7 @@ namespace snapper
 	int r1 = ioctl(dest_fd, BTRFS_IOC_CLONE, src_fd);
 	if (r1 != 0)
 	{
-	    // TODO: too much logging with LVM
-	    // y2err("ioctl failed errno:" << errno << " (" << stringerror(errno) << ")");
+	    y2err("ioctl failed errno:" << errno << " (" << stringerror(errno) << ")");
 	}
 
 	return r1 == 0;
diff --git a/snapper/File.cc b/snapper/File.cc
index 17a4aab..c063619 100644
--- a/snapper/File.cc
+++ b/snapper/File.cc
@@ -394,7 +394,7 @@ namespace snapper
 	bool ret = clonefile(src_fd, dest_fd) || copyfile(src_fd, dest_fd);
 	if (!ret)
 	{
-	    y2err("clone and copy failed " << getAbsolutePath(LOC_SYSTEM));
+	    y2err("clone and copy failed " << getAbsolutePath(LOC_PRE) << " => " << getAbsolutePath(LOC_SYSTEM));
 	}
 
 	close(dest_fd);
-- 
2.9.3

