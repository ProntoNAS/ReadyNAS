/*
 * Cryptographic API.
 *
 * CRC32C chksum
 * High Octane CRC32C calculation with the Intel Slicing-by-8 Algorithm
 *
 * Copyright (c) 2013 NETGEAR, Inc.
 *
 * This is an implementation of the following Intel 2006 white paper:
 *	High Octane CRC Generation with the Intel Slicing-by-8 Algorithm
 * http://download.intel.com/technology/comms/perfnet/download/slicing-by-8.pdf
 *
 * This algorithm resulted 2x faster than a conventional byte-by-bye table-
 * look-up algorithm on a Marvell ARMADA370 ARM platform with a cost of 8x
 * table size.
 *
 * This program is free software; you can redistribute it and/or modify it
 * under the terms of the GNU General Public License as published by the Free
 * Software Foundation; either version 2 of the License, or (at your option)
 * any later version.
 *
 */

#include <crypto/internal/hash.h>
#include <linux/init.h>
#include <linux/module.h>
#include <linux/string.h>
#include <linux/async_tx.h>
#include <linux/mm.h>
#include <linux/kernel.h>

#define CHKSUM_BLOCK_SIZE	1
#define CHKSUM_DIGEST_SIZE	sizeof(u32)

struct chksum_ctx {
	u32 key;
};

struct chksum_desc_ctx {
	u32 crc;
};

/*
   poly = 0x82f63b78   # crc32c
   crc0 = Array.new
   (0..255).each {|i|
     crc0[i] = i
     (0..7).each {|j|
       crc0[i] = (crc0[i] >> 1 ) ^ ((crc0[i] & 1)==0 ? 0 : poly)
     }
     printf "#{format("0x%08xL, ", crc0[i])}"
     printf "\n" if (i%8)==7
   }

   crc = crc0.dup
   (1..7).each {|k|
     puts
     (0..255).each {|i|
       crc[i] = (crc[i] >> 8) ^ crc0[crc[i] & 255]
       printf "#{format("%0x08xL, ", crc[i])}"
       puts if (i%8)==7
     }
   }
 */

static const u32 crc32c_table[256*8] = {
	0x00000000L, 0xF26B8303L, 0xE13B70F7L, 0x1350F3F4L,
	0xC79A971FL, 0x35F1141CL, 0x26A1E7E8L, 0xD4CA64EBL,
	0x8AD958CFL, 0x78B2DBCCL, 0x6BE22838L, 0x9989AB3BL,
	0x4D43CFD0L, 0xBF284CD3L, 0xAC78BF27L, 0x5E133C24L,
	0x105EC76FL, 0xE235446CL, 0xF165B798L, 0x030E349BL,
	0xD7C45070L, 0x25AFD373L, 0x36FF2087L, 0xC494A384L,
	0x9A879FA0L, 0x68EC1CA3L, 0x7BBCEF57L, 0x89D76C54L,
	0x5D1D08BFL, 0xAF768BBCL, 0xBC267848L, 0x4E4DFB4BL,
	0x20BD8EDEL, 0xD2D60DDDL, 0xC186FE29L, 0x33ED7D2AL,
	0xE72719C1L, 0x154C9AC2L, 0x061C6936L, 0xF477EA35L,
	0xAA64D611L, 0x580F5512L, 0x4B5FA6E6L, 0xB93425E5L,
	0x6DFE410EL, 0x9F95C20DL, 0x8CC531F9L, 0x7EAEB2FAL,
	0x30E349B1L, 0xC288CAB2L, 0xD1D83946L, 0x23B3BA45L,
	0xF779DEAEL, 0x05125DADL, 0x1642AE59L, 0xE4292D5AL,
	0xBA3A117EL, 0x4851927DL, 0x5B016189L, 0xA96AE28AL,
	0x7DA08661L, 0x8FCB0562L, 0x9C9BF696L, 0x6EF07595L,
	0x417B1DBCL, 0xB3109EBFL, 0xA0406D4BL, 0x522BEE48L,
	0x86E18AA3L, 0x748A09A0L, 0x67DAFA54L, 0x95B17957L,
	0xCBA24573L, 0x39C9C670L, 0x2A993584L, 0xD8F2B687L,
	0x0C38D26CL, 0xFE53516FL, 0xED03A29BL, 0x1F682198L,
	0x5125DAD3L, 0xA34E59D0L, 0xB01EAA24L, 0x42752927L,
	0x96BF4DCCL, 0x64D4CECFL, 0x77843D3BL, 0x85EFBE38L,
	0xDBFC821CL, 0x2997011FL, 0x3AC7F2EBL, 0xC8AC71E8L,
	0x1C661503L, 0xEE0D9600L, 0xFD5D65F4L, 0x0F36E6F7L,
	0x61C69362L, 0x93AD1061L, 0x80FDE395L, 0x72966096L,
	0xA65C047DL, 0x5437877EL, 0x4767748AL, 0xB50CF789L,
	0xEB1FCBADL, 0x197448AEL, 0x0A24BB5AL, 0xF84F3859L,
	0x2C855CB2L, 0xDEEEDFB1L, 0xCDBE2C45L, 0x3FD5AF46L,
	0x7198540DL, 0x83F3D70EL, 0x90A324FAL, 0x62C8A7F9L,
	0xB602C312L, 0x44694011L, 0x5739B3E5L, 0xA55230E6L,
	0xFB410CC2L, 0x092A8FC1L, 0x1A7A7C35L, 0xE811FF36L,
	0x3CDB9BDDL, 0xCEB018DEL, 0xDDE0EB2AL, 0x2F8B6829L,
	0x82F63B78L, 0x709DB87BL, 0x63CD4B8FL, 0x91A6C88CL,
	0x456CAC67L, 0xB7072F64L, 0xA457DC90L, 0x563C5F93L,
	0x082F63B7L, 0xFA44E0B4L, 0xE9141340L, 0x1B7F9043L,
	0xCFB5F4A8L, 0x3DDE77ABL, 0x2E8E845FL, 0xDCE5075CL,
	0x92A8FC17L, 0x60C37F14L, 0x73938CE0L, 0x81F80FE3L,
	0x55326B08L, 0xA759E80BL, 0xB4091BFFL, 0x466298FCL,
	0x1871A4D8L, 0xEA1A27DBL, 0xF94AD42FL, 0x0B21572CL,
	0xDFEB33C7L, 0x2D80B0C4L, 0x3ED04330L, 0xCCBBC033L,
	0xA24BB5A6L, 0x502036A5L, 0x4370C551L, 0xB11B4652L,
	0x65D122B9L, 0x97BAA1BAL, 0x84EA524EL, 0x7681D14DL,
	0x2892ED69L, 0xDAF96E6AL, 0xC9A99D9EL, 0x3BC21E9DL,
	0xEF087A76L, 0x1D63F975L, 0x0E330A81L, 0xFC588982L,
	0xB21572C9L, 0x407EF1CAL, 0x532E023EL, 0xA145813DL,
	0x758FE5D6L, 0x87E466D5L, 0x94B49521L, 0x66DF1622L,
	0x38CC2A06L, 0xCAA7A905L, 0xD9F75AF1L, 0x2B9CD9F2L,
	0xFF56BD19L, 0x0D3D3E1AL, 0x1E6DCDEEL, 0xEC064EEDL,
	0xC38D26C4L, 0x31E6A5C7L, 0x22B65633L, 0xD0DDD530L,
	0x0417B1DBL, 0xF67C32D8L, 0xE52CC12CL, 0x1747422FL,
	0x49547E0BL, 0xBB3FFD08L, 0xA86F0EFCL, 0x5A048DFFL,
	0x8ECEE914L, 0x7CA56A17L, 0x6FF599E3L, 0x9D9E1AE0L,
	0xD3D3E1ABL, 0x21B862A8L, 0x32E8915CL, 0xC083125FL,
	0x144976B4L, 0xE622F5B7L, 0xF5720643L, 0x07198540L,
	0x590AB964L, 0xAB613A67L, 0xB831C993L, 0x4A5A4A90L,
	0x9E902E7BL, 0x6CFBAD78L, 0x7FAB5E8CL, 0x8DC0DD8FL,
	0xE330A81AL, 0x115B2B19L, 0x020BD8EDL, 0xF0605BEEL,
	0x24AA3F05L, 0xD6C1BC06L, 0xC5914FF2L, 0x37FACCF1L,
	0x69E9F0D5L, 0x9B8273D6L, 0x88D28022L, 0x7AB90321L,
	0xAE7367CAL, 0x5C18E4C9L, 0x4F48173DL, 0xBD23943EL,
	0xF36E6F75L, 0x0105EC76L, 0x12551F82L, 0xE03E9C81L,
	0x34F4F86AL, 0xC69F7B69L, 0xD5CF889DL, 0x27A40B9EL,
	0x79B737BAL, 0x8BDCB4B9L, 0x988C474DL, 0x6AE7C44EL,
	0xBE2DA0A5L, 0x4C4623A6L, 0x5F16D052L, 0xAD7D5351L,

	0x00000000L, 0x13a29877L, 0x274530eeL, 0x34e7a899L,
	0x4e8a61dcL, 0x5d28f9abL, 0x69cf5132L, 0x7a6dc945L,
	0x9d14c3b8L, 0x8eb65bcfL, 0xba51f356L, 0xa9f36b21L,
	0xd39ea264L, 0xc03c3a13L, 0xf4db928aL, 0xe7790afdL,
	0x3fc5f181L, 0x2c6769f6L, 0x1880c16fL, 0x0b225918L,
	0x714f905dL, 0x62ed082aL, 0x560aa0b3L, 0x45a838c4L,
	0xa2d13239L, 0xb173aa4eL, 0x859402d7L, 0x96369aa0L,
	0xec5b53e5L, 0xfff9cb92L, 0xcb1e630bL, 0xd8bcfb7cL,
	0x7f8be302L, 0x6c297b75L, 0x58ced3ecL, 0x4b6c4b9bL,
	0x310182deL, 0x22a31aa9L, 0x1644b230L, 0x05e62a47L,
	0xe29f20baL, 0xf13db8cdL, 0xc5da1054L, 0xd6788823L,
	0xac154166L, 0xbfb7d911L, 0x8b507188L, 0x98f2e9ffL,
	0x404e1283L, 0x53ec8af4L, 0x670b226dL, 0x74a9ba1aL,
	0x0ec4735fL, 0x1d66eb28L, 0x298143b1L, 0x3a23dbc6L,
	0xdd5ad13bL, 0xcef8494cL, 0xfa1fe1d5L, 0xe9bd79a2L,
	0x93d0b0e7L, 0x80722890L, 0xb4958009L, 0xa737187eL,
	0xff17c604L, 0xecb55e73L, 0xd852f6eaL, 0xcbf06e9dL,
	0xb19da7d8L, 0xa23f3fafL, 0x96d89736L, 0x857a0f41L,
	0x620305bcL, 0x71a19dcbL, 0x45463552L, 0x56e4ad25L,
	0x2c896460L, 0x3f2bfc17L, 0x0bcc548eL, 0x186eccf9L,
	0xc0d23785L, 0xd370aff2L, 0xe797076bL, 0xf4359f1cL,
	0x8e585659L, 0x9dface2eL, 0xa91d66b7L, 0xbabffec0L,
	0x5dc6f43dL, 0x4e646c4aL, 0x7a83c4d3L, 0x69215ca4L,
	0x134c95e1L, 0x00ee0d96L, 0x3409a50fL, 0x27ab3d78L,
	0x809c2506L, 0x933ebd71L, 0xa7d915e8L, 0xb47b8d9fL,
	0xce1644daL, 0xddb4dcadL, 0xe9537434L, 0xfaf1ec43L,
	0x1d88e6beL, 0x0e2a7ec9L, 0x3acdd650L, 0x296f4e27L,
	0x53028762L, 0x40a01f15L, 0x7447b78cL, 0x67e52ffbL,
	0xbf59d487L, 0xacfb4cf0L, 0x981ce469L, 0x8bbe7c1eL,
	0xf1d3b55bL, 0xe2712d2cL, 0xd69685b5L, 0xc5341dc2L,
	0x224d173fL, 0x31ef8f48L, 0x050827d1L, 0x16aabfa6L,
	0x6cc776e3L, 0x7f65ee94L, 0x4b82460dL, 0x5820de7aL,
	0xfbc3faf9L, 0xe861628eL, 0xdc86ca17L, 0xcf245260L,
	0xb5499b25L, 0xa6eb0352L, 0x920cabcbL, 0x81ae33bcL,
	0x66d73941L, 0x7575a136L, 0x419209afL, 0x523091d8L,
	0x285d589dL, 0x3bffc0eaL, 0x0f186873L, 0x1cbaf004L,
	0xc4060b78L, 0xd7a4930fL, 0xe3433b96L, 0xf0e1a3e1L,
	0x8a8c6aa4L, 0x992ef2d3L, 0xadc95a4aL, 0xbe6bc23dL,
	0x5912c8c0L, 0x4ab050b7L, 0x7e57f82eL, 0x6df56059L,
	0x1798a91cL, 0x043a316bL, 0x30dd99f2L, 0x237f0185L,
	0x844819fbL, 0x97ea818cL, 0xa30d2915L, 0xb0afb162L,
	0xcac27827L, 0xd960e050L, 0xed8748c9L, 0xfe25d0beL,
	0x195cda43L, 0x0afe4234L, 0x3e19eaadL, 0x2dbb72daL,
	0x57d6bb9fL, 0x447423e8L, 0x70938b71L, 0x63311306L,
	0xbb8de87aL, 0xa82f700dL, 0x9cc8d894L, 0x8f6a40e3L,
	0xf50789a6L, 0xe6a511d1L, 0xd242b948L, 0xc1e0213fL,
	0x26992bc2L, 0x353bb3b5L, 0x01dc1b2cL, 0x127e835bL,
	0x68134a1eL, 0x7bb1d269L, 0x4f567af0L, 0x5cf4e287L,
	0x04d43cfdL, 0x1776a48aL, 0x23910c13L, 0x30339464L,
	0x4a5e5d21L, 0x59fcc556L, 0x6d1b6dcfL, 0x7eb9f5b8L,
	0x99c0ff45L, 0x8a626732L, 0xbe85cfabL, 0xad2757dcL,
	0xd74a9e99L, 0xc4e806eeL, 0xf00fae77L, 0xe3ad3600L,
	0x3b11cd7cL, 0x28b3550bL, 0x1c54fd92L, 0x0ff665e5L,
	0x759baca0L, 0x663934d7L, 0x52de9c4eL, 0x417c0439L,
	0xa6050ec4L, 0xb5a796b3L, 0x81403e2aL, 0x92e2a65dL,
	0xe88f6f18L, 0xfb2df76fL, 0xcfca5ff6L, 0xdc68c781L,
	0x7b5fdfffL, 0x68fd4788L, 0x5c1aef11L, 0x4fb87766L,
	0x35d5be23L, 0x26772654L, 0x12908ecdL, 0x013216baL,
	0xe64b1c47L, 0xf5e98430L, 0xc10e2ca9L, 0xd2acb4deL,
	0xa8c17d9bL, 0xbb63e5ecL, 0x8f844d75L, 0x9c26d502L,
	0x449a2e7eL, 0x5738b609L, 0x63df1e90L, 0x707d86e7L,
	0x0a104fa2L, 0x19b2d7d5L, 0x2d557f4cL, 0x3ef7e73bL,
	0xd98eedc6L, 0xca2c75b1L, 0xfecbdd28L, 0xed69455fL,
	0x97048c1aL, 0x84a6146dL, 0xb041bcf4L, 0xa3e32483L,

	0x00000000L, 0xa541927eL, 0x4f6f520dL, 0xea2ec073L,
	0x9edea41aL, 0x3b9f3664L, 0xd1b1f617L, 0x74f06469L,
	0x38513ec5L, 0x9d10acbbL, 0x773e6cc8L, 0xd27ffeb6L,
	0xa68f9adfL, 0x03ce08a1L, 0xe9e0c8d2L, 0x4ca15aacL,
	0x70a27d8aL, 0xd5e3eff4L, 0x3fcd2f87L, 0x9a8cbdf9L,
	0xee7cd990L, 0x4b3d4beeL, 0xa1138b9dL, 0x045219e3L,
	0x48f3434fL, 0xedb2d131L, 0x079c1142L, 0xa2dd833cL,
	0xd62de755L, 0x736c752bL, 0x9942b558L, 0x3c032726L,
	0xe144fb14L, 0x4405696aL, 0xae2ba919L, 0x0b6a3b67L,
	0x7f9a5f0eL, 0xdadbcd70L, 0x30f50d03L, 0x95b49f7dL,
	0xd915c5d1L, 0x7c5457afL, 0x967a97dcL, 0x333b05a2L,
	0x47cb61cbL, 0xe28af3b5L, 0x08a433c6L, 0xade5a1b8L,
	0x91e6869eL, 0x34a714e0L, 0xde89d493L, 0x7bc846edL,
	0x0f382284L, 0xaa79b0faL, 0x40577089L, 0xe516e2f7L,
	0xa9b7b85bL, 0x0cf62a25L, 0xe6d8ea56L, 0x43997828L,
	0x37691c41L, 0x92288e3fL, 0x78064e4cL, 0xdd47dc32L,
	0xc76580d9L, 0x622412a7L, 0x880ad2d4L, 0x2d4b40aaL,
	0x59bb24c3L, 0xfcfab6bdL, 0x16d476ceL, 0xb395e4b0L,
	0xff34be1cL, 0x5a752c62L, 0xb05bec11L, 0x151a7e6fL,
	0x61ea1a06L, 0xc4ab8878L, 0x2e85480bL, 0x8bc4da75L,
	0xb7c7fd53L, 0x12866f2dL, 0xf8a8af5eL, 0x5de93d20L,
	0x29195949L, 0x8c58cb37L, 0x66760b44L, 0xc337993aL,
	0x8f96c396L, 0x2ad751e8L, 0xc0f9919bL, 0x65b803e5L,
	0x1148678cL, 0xb409f5f2L, 0x5e273581L, 0xfb66a7ffL,
	0x26217bcdL, 0x8360e9b3L, 0x694e29c0L, 0xcc0fbbbeL,
	0xb8ffdfd7L, 0x1dbe4da9L, 0xf7908ddaL, 0x52d11fa4L,
	0x1e704508L, 0xbb31d776L, 0x511f1705L, 0xf45e857bL,
	0x80aee112L, 0x25ef736cL, 0xcfc1b31fL, 0x6a802161L,
	0x56830647L, 0xf3c29439L, 0x19ec544aL, 0xbcadc634L,
	0xc85da25dL, 0x6d1c3023L, 0x8732f050L, 0x2273622eL,
	0x6ed23882L, 0xcb93aafcL, 0x21bd6a8fL, 0x84fcf8f1L,
	0xf00c9c98L, 0x554d0ee6L, 0xbf63ce95L, 0x1a225cebL,
	0x8b277743L, 0x2e66e53dL, 0xc448254eL, 0x6109b730L,
	0x15f9d359L, 0xb0b84127L, 0x5a968154L, 0xffd7132aL,
	0xb3764986L, 0x1637dbf8L, 0xfc191b8bL, 0x595889f5L,
	0x2da8ed9cL, 0x88e97fe2L, 0x62c7bf91L, 0xc7862defL,
	0xfb850ac9L, 0x5ec498b7L, 0xb4ea58c4L, 0x11abcabaL,
	0x655baed3L, 0xc01a3cadL, 0x2a34fcdeL, 0x8f756ea0L,
	0xc3d4340cL, 0x6695a672L, 0x8cbb6601L, 0x29faf47fL,
	0x5d0a9016L, 0xf84b0268L, 0x1265c21bL, 0xb7245065L,
	0x6a638c57L, 0xcf221e29L, 0x250cde5aL, 0x804d4c24L,
	0xf4bd284dL, 0x51fcba33L, 0xbbd27a40L, 0x1e93e83eL,
	0x5232b292L, 0xf77320ecL, 0x1d5de09fL, 0xb81c72e1L,
	0xccec1688L, 0x69ad84f6L, 0x83834485L, 0x26c2d6fbL,
	0x1ac1f1ddL, 0xbf8063a3L, 0x55aea3d0L, 0xf0ef31aeL,
	0x841f55c7L, 0x215ec7b9L, 0xcb7007caL, 0x6e3195b4L,
	0x2290cf18L, 0x87d15d66L, 0x6dff9d15L, 0xc8be0f6bL,
	0xbc4e6b02L, 0x190ff97cL, 0xf321390fL, 0x5660ab71L,
	0x4c42f79aL, 0xe90365e4L, 0x032da597L, 0xa66c37e9L,
	0xd29c5380L, 0x77ddc1feL, 0x9df3018dL, 0x38b293f3L,
	0x7413c95fL, 0xd1525b21L, 0x3b7c9b52L, 0x9e3d092cL,
	0xeacd6d45L, 0x4f8cff3bL, 0xa5a23f48L, 0x00e3ad36L,
	0x3ce08a10L, 0x99a1186eL, 0x738fd81dL, 0xd6ce4a63L,
	0xa23e2e0aL, 0x077fbc74L, 0xed517c07L, 0x4810ee79L,
	0x04b1b4d5L, 0xa1f026abL, 0x4bdee6d8L, 0xee9f74a6L,
	0x9a6f10cfL, 0x3f2e82b1L, 0xd50042c2L, 0x7041d0bcL,
	0xad060c8eL, 0x08479ef0L, 0xe2695e83L, 0x4728ccfdL,
	0x33d8a894L, 0x96993aeaL, 0x7cb7fa99L, 0xd9f668e7L,
	0x9557324bL, 0x3016a035L, 0xda386046L, 0x7f79f238L,
	0x0b899651L, 0xaec8042fL, 0x44e6c45cL, 0xe1a75622L,
	0xdda47104L, 0x78e5e37aL, 0x92cb2309L, 0x378ab177L,
	0x437ad51eL, 0xe63b4760L, 0x0c158713L, 0xa954156dL,
	0xe5f54fc1L, 0x40b4ddbfL, 0xaa9a1dccL, 0x0fdb8fb2L,
	0x7b2bebdbL, 0xde6a79a5L, 0x3444b9d6L, 0x91052ba8L,

	0x00000000L, 0xdd45aab8L, 0xbf672381L, 0x62228939L,
	0x7b2231f3L, 0xa6679b4bL, 0xc4451272L, 0x1900b8caL,
	0xf64463e6L, 0x2b01c95eL, 0x49234067L, 0x9466eadfL,
	0x8d665215L, 0x5023f8adL, 0x32017194L, 0xef44db2cL,
	0xe964b13dL, 0x34211b85L, 0x560392bcL, 0x8b463804L,
	0x924680ceL, 0x4f032a76L, 0x2d21a34fL, 0xf06409f7L,
	0x1f20d2dbL, 0xc2657863L, 0xa047f15aL, 0x7d025be2L,
	0x6402e328L, 0xb9474990L, 0xdb65c0a9L, 0x06206a11L,
	0xd725148bL, 0x0a60be33L, 0x6842370aL, 0xb5079db2L,
	0xac072578L, 0x71428fc0L, 0x136006f9L, 0xce25ac41L,
	0x2161776dL, 0xfc24ddd5L, 0x9e0654ecL, 0x4343fe54L,
	0x5a43469eL, 0x8706ec26L, 0xe524651fL, 0x3861cfa7L,
	0x3e41a5b6L, 0xe3040f0eL, 0x81268637L, 0x5c632c8fL,
	0x45639445L, 0x98263efdL, 0xfa04b7c4L, 0x27411d7cL,
	0xc805c650L, 0x15406ce8L, 0x7762e5d1L, 0xaa274f69L,
	0xb327f7a3L, 0x6e625d1bL, 0x0c40d422L, 0xd1057e9aL,
	0xaba65fe7L, 0x76e3f55fL, 0x14c17c66L, 0xc984d6deL,
	0xd0846e14L, 0x0dc1c4acL, 0x6fe34d95L, 0xb2a6e72dL,
	0x5de23c01L, 0x80a796b9L, 0xe2851f80L, 0x3fc0b538L,
	0x26c00df2L, 0xfb85a74aL, 0x99a72e73L, 0x44e284cbL,
	0x42c2eedaL, 0x9f874462L, 0xfda5cd5bL, 0x20e067e3L,
	0x39e0df29L, 0xe4a57591L, 0x8687fca8L, 0x5bc25610L,
	0xb4868d3cL, 0x69c32784L, 0x0be1aebdL, 0xd6a40405L,
	0xcfa4bccfL, 0x12e11677L, 0x70c39f4eL, 0xad8635f6L,
	0x7c834b6cL, 0xa1c6e1d4L, 0xc3e468edL, 0x1ea1c255L,
	0x07a17a9fL, 0xdae4d027L, 0xb8c6591eL, 0x6583f3a6L,
	0x8ac7288aL, 0x57828232L, 0x35a00b0bL, 0xe8e5a1b3L,
	0xf1e51979L, 0x2ca0b3c1L, 0x4e823af8L, 0x93c79040L,
	0x95e7fa51L, 0x48a250e9L, 0x2a80d9d0L, 0xf7c57368L,
	0xeec5cba2L, 0x3380611aL, 0x51a2e823L, 0x8ce7429bL,
	0x63a399b7L, 0xbee6330fL, 0xdcc4ba36L, 0x0181108eL,
	0x1881a844L, 0xc5c402fcL, 0xa7e68bc5L, 0x7aa3217dL,
	0x52a0c93fL, 0x8fe56387L, 0xedc7eabeL, 0x30824006L,
	0x2982f8ccL, 0xf4c75274L, 0x96e5db4dL, 0x4ba071f5L,
	0xa4e4aad9L, 0x79a10061L, 0x1b838958L, 0xc6c623e0L,
	0xdfc69b2aL, 0x02833192L, 0x60a1b8abL, 0xbde41213L,
	0xbbc47802L, 0x6681d2baL, 0x04a35b83L, 0xd9e6f13bL,
	0xc0e649f1L, 0x1da3e349L, 0x7f816a70L, 0xa2c4c0c8L,
	0x4d801be4L, 0x90c5b15cL, 0xf2e73865L, 0x2fa292ddL,
	0x36a22a17L, 0xebe780afL, 0x89c50996L, 0x5480a32eL,
	0x8585ddb4L, 0x58c0770cL, 0x3ae2fe35L, 0xe7a7548dL,
	0xfea7ec47L, 0x23e246ffL, 0x41c0cfc6L, 0x9c85657eL,
	0x73c1be52L, 0xae8414eaL, 0xcca69dd3L, 0x11e3376bL,
	0x08e38fa1L, 0xd5a62519L, 0xb784ac20L, 0x6ac10698L,
	0x6ce16c89L, 0xb1a4c631L, 0xd3864f08L, 0x0ec3e5b0L,
	0x17c35d7aL, 0xca86f7c2L, 0xa8a47efbL, 0x75e1d443L,
	0x9aa50f6fL, 0x47e0a5d7L, 0x25c22ceeL, 0xf8878656L,
	0xe1873e9cL, 0x3cc29424L, 0x5ee01d1dL, 0x83a5b7a5L,
	0xf90696d8L, 0x24433c60L, 0x4661b559L, 0x9b241fe1L,
	0x8224a72bL, 0x5f610d93L, 0x3d4384aaL, 0xe0062e12L,
	0x0f42f53eL, 0xd2075f86L, 0xb025d6bfL, 0x6d607c07L,
	0x7460c4cdL, 0xa9256e75L, 0xcb07e74cL, 0x16424df4L,
	0x106227e5L, 0xcd278d5dL, 0xaf050464L, 0x7240aedcL,
	0x6b401616L, 0xb605bcaeL, 0xd4273597L, 0x09629f2fL,
	0xe6264403L, 0x3b63eebbL, 0x59416782L, 0x8404cd3aL,
	0x9d0475f0L, 0x4041df48L, 0x22635671L, 0xff26fcc9L,
	0x2e238253L, 0xf36628ebL, 0x9144a1d2L, 0x4c010b6aL,
	0x5501b3a0L, 0x88441918L, 0xea669021L, 0x37233a99L,
	0xd867e1b5L, 0x05224b0dL, 0x6700c234L, 0xba45688cL,
	0xa345d046L, 0x7e007afeL, 0x1c22f3c7L, 0xc167597fL,
	0xc747336eL, 0x1a0299d6L, 0x782010efL, 0xa565ba57L,
	0xbc65029dL, 0x6120a825L, 0x0302211cL, 0xde478ba4L,
	0x31035088L, 0xec46fa30L, 0x8e647309L, 0x5321d9b1L,
	0x4a21617bL, 0x9764cbc3L, 0xf54642faL, 0x2803e842L,

	0x00000000L, 0x38116facL, 0x7022df58L, 0x4833b0f4L,
	0xe045beb0L, 0xd854d11cL, 0x906761e8L, 0xa8760e44L,
	0xc5670b91L, 0xfd76643dL, 0xb545d4c9L, 0x8d54bb65L,
	0x2522b521L, 0x1d33da8dL, 0x55006a79L, 0x6d1105d5L,
	0x8f2261d3L, 0xb7330e7fL, 0xff00be8bL, 0xc711d127L,
	0x6f67df63L, 0x5776b0cfL, 0x1f45003bL, 0x27546f97L,
	0x4a456a42L, 0x725405eeL, 0x3a67b51aL, 0x0276dab6L,
	0xaa00d4f2L, 0x9211bb5eL, 0xda220baaL, 0xe2336406L,
	0x1ba8b557L, 0x23b9dafbL, 0x6b8a6a0fL, 0x539b05a3L,
	0xfbed0be7L, 0xc3fc644bL, 0x8bcfd4bfL, 0xb3debb13L,
	0xdecfbec6L, 0xe6ded16aL, 0xaeed619eL, 0x96fc0e32L,
	0x3e8a0076L, 0x069b6fdaL, 0x4ea8df2eL, 0x76b9b082L,
	0x948ad484L, 0xac9bbb28L, 0xe4a80bdcL, 0xdcb96470L,
	0x74cf6a34L, 0x4cde0598L, 0x04edb56cL, 0x3cfcdac0L,
	0x51eddf15L, 0x69fcb0b9L, 0x21cf004dL, 0x19de6fe1L,
	0xb1a861a5L, 0x89b90e09L, 0xc18abefdL, 0xf99bd151L,
	0x37516aaeL, 0x0f400502L, 0x4773b5f6L, 0x7f62da5aL,
	0xd714d41eL, 0xef05bbb2L, 0xa7360b46L, 0x9f2764eaL,
	0xf236613fL, 0xca270e93L, 0x8214be67L, 0xba05d1cbL,
	0x1273df8fL, 0x2a62b023L, 0x625100d7L, 0x5a406f7bL,
	0xb8730b7dL, 0x806264d1L, 0xc851d425L, 0xf040bb89L,
	0x5836b5cdL, 0x6027da61L, 0x28146a95L, 0x10050539L,
	0x7d1400ecL, 0x45056f40L, 0x0d36dfb4L, 0x3527b018L,
	0x9d51be5cL, 0xa540d1f0L, 0xed736104L, 0xd5620ea8L,
	0x2cf9dff9L, 0x14e8b055L, 0x5cdb00a1L, 0x64ca6f0dL,
	0xccbc6149L, 0xf4ad0ee5L, 0xbc9ebe11L, 0x848fd1bdL,
	0xe99ed468L, 0xd18fbbc4L, 0x99bc0b30L, 0xa1ad649cL,
	0x09db6ad8L, 0x31ca0574L, 0x79f9b580L, 0x41e8da2cL,
	0xa3dbbe2aL, 0x9bcad186L, 0xd3f96172L, 0xebe80edeL,
	0x439e009aL, 0x7b8f6f36L, 0x33bcdfc2L, 0x0badb06eL,
	0x66bcb5bbL, 0x5eadda17L, 0x169e6ae3L, 0x2e8f054fL,
	0x86f90b0bL, 0xbee864a7L, 0xf6dbd453L, 0xcecabbffL,
	0x6ea2d55cL, 0x56b3baf0L, 0x1e800a04L, 0x269165a8L,
	0x8ee76becL, 0xb6f60440L, 0xfec5b4b4L, 0xc6d4db18L,
	0xabc5decdL, 0x93d4b161L, 0xdbe70195L, 0xe3f66e39L,
	0x4b80607dL, 0x73910fd1L, 0x3ba2bf25L, 0x03b3d089L,
	0xe180b48fL, 0xd991db23L, 0x91a26bd7L, 0xa9b3047bL,
	0x01c50a3fL, 0x39d46593L, 0x71e7d567L, 0x49f6bacbL,
	0x24e7bf1eL, 0x1cf6d0b2L, 0x54c56046L, 0x6cd40feaL,
	0xc4a201aeL, 0xfcb36e02L, 0xb480def6L, 0x8c91b15aL,
	0x750a600bL, 0x4d1b0fa7L, 0x0528bf53L, 0x3d39d0ffL,
	0x954fdebbL, 0xad5eb117L, 0xe56d01e3L, 0xdd7c6e4fL,
	0xb06d6b9aL, 0x887c0436L, 0xc04fb4c2L, 0xf85edb6eL,
	0x5028d52aL, 0x6839ba86L, 0x200a0a72L, 0x181b65deL,
	0xfa2801d8L, 0xc2396e74L, 0x8a0ade80L, 0xb21bb12cL,
	0x1a6dbf68L, 0x227cd0c4L, 0x6a4f6030L, 0x525e0f9cL,
	0x3f4f0a49L, 0x075e65e5L, 0x4f6dd511L, 0x777cbabdL,
	0xdf0ab4f9L, 0xe71bdb55L, 0xaf286ba1L, 0x9739040dL,
	0x59f3bff2L, 0x61e2d05eL, 0x29d160aaL, 0x11c00f06L,
	0xb9b60142L, 0x81a76eeeL, 0xc994de1aL, 0xf185b1b6L,
	0x9c94b463L, 0xa485dbcfL, 0xecb66b3bL, 0xd4a70497L,
	0x7cd10ad3L, 0x44c0657fL, 0x0cf3d58bL, 0x34e2ba27L,
	0xd6d1de21L, 0xeec0b18dL, 0xa6f30179L, 0x9ee26ed5L,
	0x36946091L, 0x0e850f3dL, 0x46b6bfc9L, 0x7ea7d065L,
	0x13b6d5b0L, 0x2ba7ba1cL, 0x63940ae8L, 0x5b856544L,
	0xf3f36b00L, 0xcbe204acL, 0x83d1b458L, 0xbbc0dbf4L,
	0x425b0aa5L, 0x7a4a6509L, 0x3279d5fdL, 0x0a68ba51L,
	0xa21eb415L, 0x9a0fdbb9L, 0xd23c6b4dL, 0xea2d04e1L,
	0x873c0134L, 0xbf2d6e98L, 0xf71ede6cL, 0xcf0fb1c0L,
	0x6779bf84L, 0x5f68d028L, 0x175b60dcL, 0x2f4a0f70L,
	0xcd796b76L, 0xf56804daL, 0xbd5bb42eL, 0x854adb82L,
	0x2d3cd5c6L, 0x152dba6aL, 0x5d1e0a9eL, 0x650f6532L,
	0x081e60e7L, 0x300f0f4bL, 0x783cbfbfL, 0x402dd013L,
	0xe85bde57L, 0xd04ab1fbL, 0x9879010fL, 0xa0686ea3L,

	0x00000000L, 0xef306b19L, 0xdb8ca0c3L, 0x34bccbdaL,
	0xb2f53777L, 0x5dc55c6eL, 0x697997b4L, 0x8649fcadL,
	0x6006181fL, 0x8f367306L, 0xbb8ab8dcL, 0x54bad3c5L,
	0xd2f32f68L, 0x3dc34471L, 0x097f8fabL, 0xe64fe4b2L,
	0xc00c303eL, 0x2f3c5b27L, 0x1b8090fdL, 0xf4b0fbe4L,
	0x72f90749L, 0x9dc96c50L, 0xa975a78aL, 0x4645cc93L,
	0xa00a2821L, 0x4f3a4338L, 0x7b8688e2L, 0x94b6e3fbL,
	0x12ff1f56L, 0xfdcf744fL, 0xc973bf95L, 0x2643d48cL,
	0x85f4168dL, 0x6ac47d94L, 0x5e78b64eL, 0xb148dd57L,
	0x370121faL, 0xd8314ae3L, 0xec8d8139L, 0x03bdea20L,
	0xe5f20e92L, 0x0ac2658bL, 0x3e7eae51L, 0xd14ec548L,
	0x570739e5L, 0xb83752fcL, 0x8c8b9926L, 0x63bbf23fL,
	0x45f826b3L, 0xaac84daaL, 0x9e748670L, 0x7144ed69L,
	0xf70d11c4L, 0x183d7addL, 0x2c81b107L, 0xc3b1da1eL,
	0x25fe3eacL, 0xcace55b5L, 0xfe729e6fL, 0x1142f576L,
	0x970b09dbL, 0x783b62c2L, 0x4c87a918L, 0xa3b7c201L,
	0x0e045bebL, 0xe13430f2L, 0xd588fb28L, 0x3ab89031L,
	0xbcf16c9cL, 0x53c10785L, 0x677dcc5fL, 0x884da746L,
	0x6e0243f4L, 0x813228edL, 0xb58ee337L, 0x5abe882eL,
	0xdcf77483L, 0x33c71f9aL, 0x077bd440L, 0xe84bbf59L,
	0xce086bd5L, 0x213800ccL, 0x1584cb16L, 0xfab4a00fL,
	0x7cfd5ca2L, 0x93cd37bbL, 0xa771fc61L, 0x48419778L,
	0xae0e73caL, 0x413e18d3L, 0x7582d309L, 0x9ab2b810L,
	0x1cfb44bdL, 0xf3cb2fa4L, 0xc777e47eL, 0x28478f67L,
	0x8bf04d66L, 0x64c0267fL, 0x507ceda5L, 0xbf4c86bcL,
	0x39057a11L, 0xd6351108L, 0xe289dad2L, 0x0db9b1cbL,
	0xebf65579L, 0x04c63e60L, 0x307af5baL, 0xdf4a9ea3L,
	0x5903620eL, 0xb6330917L, 0x828fc2cdL, 0x6dbfa9d4L,
	0x4bfc7d58L, 0xa4cc1641L, 0x9070dd9bL, 0x7f40b682L,
	0xf9094a2fL, 0x16392136L, 0x2285eaecL, 0xcdb581f5L,
	0x2bfa6547L, 0xc4ca0e5eL, 0xf076c584L, 0x1f46ae9dL,
	0x990f5230L, 0x763f3929L, 0x4283f2f3L, 0xadb399eaL,
	0x1c08b7d6L, 0xf338dccfL, 0xc7841715L, 0x28b47c0cL,
	0xaefd80a1L, 0x41cdebb8L, 0x75712062L, 0x9a414b7bL,
	0x7c0eafc9L, 0x933ec4d0L, 0xa7820f0aL, 0x48b26413L,
	0xcefb98beL, 0x21cbf3a7L, 0x1577387dL, 0xfa475364L,
	0xdc0487e8L, 0x3334ecf1L, 0x0788272bL, 0xe8b84c32L,
	0x6ef1b09fL, 0x81c1db86L, 0xb57d105cL, 0x5a4d7b45L,
	0xbc029ff7L, 0x5332f4eeL, 0x678e3f34L, 0x88be542dL,
	0x0ef7a880L, 0xe1c7c399L, 0xd57b0843L, 0x3a4b635aL,
	0x99fca15bL, 0x76ccca42L, 0x42700198L, 0xad406a81L,
	0x2b09962cL, 0xc439fd35L, 0xf08536efL, 0x1fb55df6L,
	0xf9fab944L, 0x16cad25dL, 0x22761987L, 0xcd46729eL,
	0x4b0f8e33L, 0xa43fe52aL, 0x90832ef0L, 0x7fb345e9L,
	0x59f09165L, 0xb6c0fa7cL, 0x827c31a6L, 0x6d4c5abfL,
	0xeb05a612L, 0x0435cd0bL, 0x308906d1L, 0xdfb96dc8L,
	0x39f6897aL, 0xd6c6e263L, 0xe27a29b9L, 0x0d4a42a0L,
	0x8b03be0dL, 0x6433d514L, 0x508f1eceL, 0xbfbf75d7L,
	0x120cec3dL, 0xfd3c8724L, 0xc9804cfeL, 0x26b027e7L,
	0xa0f9db4aL, 0x4fc9b053L, 0x7b757b89L, 0x94451090L,
	0x720af422L, 0x9d3a9f3bL, 0xa98654e1L, 0x46b63ff8L,
	0xc0ffc355L, 0x2fcfa84cL, 0x1b736396L, 0xf443088fL,
	0xd200dc03L, 0x3d30b71aL, 0x098c7cc0L, 0xe6bc17d9L,
	0x60f5eb74L, 0x8fc5806dL, 0xbb794bb7L, 0x544920aeL,
	0xb206c41cL, 0x5d36af05L, 0x698a64dfL, 0x86ba0fc6L,
	0x00f3f36bL, 0xefc39872L, 0xdb7f53a8L, 0x344f38b1L,
	0x97f8fab0L, 0x78c891a9L, 0x4c745a73L, 0xa344316aL,
	0x250dcdc7L, 0xca3da6deL, 0xfe816d04L, 0x11b1061dL,
	0xf7fee2afL, 0x18ce89b6L, 0x2c72426cL, 0xc3422975L,
	0x450bd5d8L, 0xaa3bbec1L, 0x9e87751bL, 0x71b71e02L,
	0x57f4ca8eL, 0xb8c4a197L, 0x8c786a4dL, 0x63480154L,
	0xe501fdf9L, 0x0a3196e0L, 0x3e8d5d3aL, 0xd1bd3623L,
	0x37f2d291L, 0xd8c2b988L, 0xec7e7252L, 0x034e194bL,
	0x8507e5e6L, 0x6a378effL, 0x5e8b4525L, 0xb1bb2e3cL,

	0x00000000L, 0x68032cc8L, 0xd0065990L, 0xb8057558L,
	0xa5e0c5d1L, 0xcde3e919L, 0x75e69c41L, 0x1de5b089L,
	0x4e2dfd53L, 0x262ed19bL, 0x9e2ba4c3L, 0xf628880bL,
	0xebcd3882L, 0x83ce144aL, 0x3bcb6112L, 0x53c84ddaL,
	0x9c5bfaa6L, 0xf458d66eL, 0x4c5da336L, 0x245e8ffeL,
	0x39bb3f77L, 0x51b813bfL, 0xe9bd66e7L, 0x81be4a2fL,
	0xd27607f5L, 0xba752b3dL, 0x02705e65L, 0x6a7372adL,
	0x7796c224L, 0x1f95eeecL, 0xa7909bb4L, 0xcf93b77cL,
	0x3d5b83bdL, 0x5558af75L, 0xed5dda2dL, 0x855ef6e5L,
	0x98bb466cL, 0xf0b86aa4L, 0x48bd1ffcL, 0x20be3334L,
	0x73767eeeL, 0x1b755226L, 0xa370277eL, 0xcb730bb6L,
	0xd696bb3fL, 0xbe9597f7L, 0x0690e2afL, 0x6e93ce67L,
	0xa100791bL, 0xc90355d3L, 0x7106208bL, 0x19050c43L,
	0x04e0bccaL, 0x6ce39002L, 0xd4e6e55aL, 0xbce5c992L,
	0xef2d8448L, 0x872ea880L, 0x3f2bddd8L, 0x5728f110L,
	0x4acd4199L, 0x22ce6d51L, 0x9acb1809L, 0xf2c834c1L,
	0x7ab7077aL, 0x12b42bb2L, 0xaab15eeaL, 0xc2b27222L,
	0xdf57c2abL, 0xb754ee63L, 0x0f519b3bL, 0x6752b7f3L,
	0x349afa29L, 0x5c99d6e1L, 0xe49ca3b9L, 0x8c9f8f71L,
	0x917a3ff8L, 0xf9791330L, 0x417c6668L, 0x297f4aa0L,
	0xe6ecfddcL, 0x8eefd114L, 0x36eaa44cL, 0x5ee98884L,
	0x430c380dL, 0x2b0f14c5L, 0x930a619dL, 0xfb094d55L,
	0xa8c1008fL, 0xc0c22c47L, 0x78c7591fL, 0x10c475d7L,
	0x0d21c55eL, 0x6522e996L, 0xdd279cceL, 0xb524b006L,
	0x47ec84c7L, 0x2fefa80fL, 0x97eadd57L, 0xffe9f19fL,
	0xe20c4116L, 0x8a0f6ddeL, 0x320a1886L, 0x5a09344eL,
	0x09c17994L, 0x61c2555cL, 0xd9c72004L, 0xb1c40cccL,
	0xac21bc45L, 0xc422908dL, 0x7c27e5d5L, 0x1424c91dL,
	0xdbb77e61L, 0xb3b452a9L, 0x0bb127f1L, 0x63b20b39L,
	0x7e57bbb0L, 0x16549778L, 0xae51e220L, 0xc652cee8L,
	0x959a8332L, 0xfd99affaL, 0x459cdaa2L, 0x2d9ff66aL,
	0x307a46e3L, 0x58796a2bL, 0xe07c1f73L, 0x887f33bbL,
	0xf56e0ef4L, 0x9d6d223cL, 0x25685764L, 0x4d6b7bacL,
	0x508ecb25L, 0x388de7edL, 0x808892b5L, 0xe88bbe7dL,
	0xbb43f3a7L, 0xd340df6fL, 0x6b45aa37L, 0x034686ffL,
	0x1ea33676L, 0x76a01abeL, 0xcea56fe6L, 0xa6a6432eL,
	0x6935f452L, 0x0136d89aL, 0xb933adc2L, 0xd130810aL,
	0xccd53183L, 0xa4d61d4bL, 0x1cd36813L, 0x74d044dbL,
	0x27180901L, 0x4f1b25c9L, 0xf71e5091L, 0x9f1d7c59L,
	0x82f8ccd0L, 0xeafbe018L, 0x52fe9540L, 0x3afdb988L,
	0xc8358d49L, 0xa036a181L, 0x1833d4d9L, 0x7030f811L,
	0x6dd54898L, 0x05d66450L, 0xbdd31108L, 0xd5d03dc0L,
	0x8618701aL, 0xee1b5cd2L, 0x561e298aL, 0x3e1d0542L,
	0x23f8b5cbL, 0x4bfb9903L, 0xf3feec5bL, 0x9bfdc093L,
	0x546e77efL, 0x3c6d5b27L, 0x84682e7fL, 0xec6b02b7L,
	0xf18eb23eL, 0x998d9ef6L, 0x2188ebaeL, 0x498bc766L,
	0x1a438abcL, 0x7240a674L, 0xca45d32cL, 0xa246ffe4L,
	0xbfa34f6dL, 0xd7a063a5L, 0x6fa516fdL, 0x07a63a35L,
	0x8fd9098eL, 0xe7da2546L, 0x5fdf501eL, 0x37dc7cd6L,
	0x2a39cc5fL, 0x423ae097L, 0xfa3f95cfL, 0x923cb907L,
	0xc1f4f4ddL, 0xa9f7d815L, 0x11f2ad4dL, 0x79f18185L,
	0x6414310cL, 0x0c171dc4L, 0xb412689cL, 0xdc114454L,
	0x1382f328L, 0x7b81dfe0L, 0xc384aab8L, 0xab878670L,
	0xb66236f9L, 0xde611a31L, 0x66646f69L, 0x0e6743a1L,
	0x5daf0e7bL, 0x35ac22b3L, 0x8da957ebL, 0xe5aa7b23L,
	0xf84fcbaaL, 0x904ce762L, 0x2849923aL, 0x404abef2L,
	0xb2828a33L, 0xda81a6fbL, 0x6284d3a3L, 0x0a87ff6bL,
	0x17624fe2L, 0x7f61632aL, 0xc7641672L, 0xaf673abaL,
	0xfcaf7760L, 0x94ac5ba8L, 0x2ca92ef0L, 0x44aa0238L,
	0x594fb2b1L, 0x314c9e79L, 0x8949eb21L, 0xe14ac7e9L,
	0x2ed97095L, 0x46da5c5dL, 0xfedf2905L, 0x96dc05cdL,
	0x8b39b544L, 0xe33a998cL, 0x5b3fecd4L, 0x333cc01cL,
	0x60f48dc6L, 0x08f7a10eL, 0xb0f2d456L, 0xd8f1f89eL,
	0xc5144817L, 0xad1764dfL, 0x15121187L, 0x7d113d4fL,

	0x00000000L, 0x493c7d27L, 0x9278fa4eL, 0xdb448769L,
	0x211d826dL, 0x6821ff4aL, 0xb3657823L, 0xfa590504L,
	0x423b04daL, 0x0b0779fdL, 0xd043fe94L, 0x997f83b3L,
	0x632686b7L, 0x2a1afb90L, 0xf15e7cf9L, 0xb86201deL,
	0x847609b4L, 0xcd4a7493L, 0x160ef3faL, 0x5f328eddL,
	0xa56b8bd9L, 0xec57f6feL, 0x37137197L, 0x7e2f0cb0L,
	0xc64d0d6eL, 0x8f717049L, 0x5435f720L, 0x1d098a07L,
	0xe7508f03L, 0xae6cf224L, 0x7528754dL, 0x3c14086aL,
	0x0d006599L, 0x443c18beL, 0x9f789fd7L, 0xd644e2f0L,
	0x2c1de7f4L, 0x65219ad3L, 0xbe651dbaL, 0xf759609dL,
	0x4f3b6143L, 0x06071c64L, 0xdd439b0dL, 0x947fe62aL,
	0x6e26e32eL, 0x271a9e09L, 0xfc5e1960L, 0xb5626447L,
	0x89766c2dL, 0xc04a110aL, 0x1b0e9663L, 0x5232eb44L,
	0xa86bee40L, 0xe1579367L, 0x3a13140eL, 0x732f6929L,
	0xcb4d68f7L, 0x827115d0L, 0x593592b9L, 0x1009ef9eL,
	0xea50ea9aL, 0xa36c97bdL, 0x782810d4L, 0x31146df3L,
	0x1a00cb32L, 0x533cb615L, 0x8878317cL, 0xc1444c5bL,
	0x3b1d495fL, 0x72213478L, 0xa965b311L, 0xe059ce36L,
	0x583bcfe8L, 0x1107b2cfL, 0xca4335a6L, 0x837f4881L,
	0x79264d85L, 0x301a30a2L, 0xeb5eb7cbL, 0xa262caecL,
	0x9e76c286L, 0xd74abfa1L, 0x0c0e38c8L, 0x453245efL,
	0xbf6b40ebL, 0xf6573dccL, 0x2d13baa5L, 0x642fc782L,
	0xdc4dc65cL, 0x9571bb7bL, 0x4e353c12L, 0x07094135L,
	0xfd504431L, 0xb46c3916L, 0x6f28be7fL, 0x2614c358L,
	0x1700aeabL, 0x5e3cd38cL, 0x857854e5L, 0xcc4429c2L,
	0x361d2cc6L, 0x7f2151e1L, 0xa465d688L, 0xed59abafL,
	0x553baa71L, 0x1c07d756L, 0xc743503fL, 0x8e7f2d18L,
	0x7426281cL, 0x3d1a553bL, 0xe65ed252L, 0xaf62af75L,
	0x9376a71fL, 0xda4ada38L, 0x010e5d51L, 0x48322076L,
	0xb26b2572L, 0xfb575855L, 0x2013df3cL, 0x692fa21bL,
	0xd14da3c5L, 0x9871dee2L, 0x4335598bL, 0x0a0924acL,
	0xf05021a8L, 0xb96c5c8fL, 0x6228dbe6L, 0x2b14a6c1L,
	0x34019664L, 0x7d3deb43L, 0xa6796c2aL, 0xef45110dL,
	0x151c1409L, 0x5c20692eL, 0x8764ee47L, 0xce589360L,
	0x763a92beL, 0x3f06ef99L, 0xe44268f0L, 0xad7e15d7L,
	0x572710d3L, 0x1e1b6df4L, 0xc55fea9dL, 0x8c6397baL,
	0xb0779fd0L, 0xf94be2f7L, 0x220f659eL, 0x6b3318b9L,
	0x916a1dbdL, 0xd856609aL, 0x0312e7f3L, 0x4a2e9ad4L,
	0xf24c9b0aL, 0xbb70e62dL, 0x60346144L, 0x29081c63L,
	0xd3511967L, 0x9a6d6440L, 0x4129e329L, 0x08159e0eL,
	0x3901f3fdL, 0x703d8edaL, 0xab7909b3L, 0xe2457494L,
	0x181c7190L, 0x51200cb7L, 0x8a648bdeL, 0xc358f6f9L,
	0x7b3af727L, 0x32068a00L, 0xe9420d69L, 0xa07e704eL,
	0x5a27754aL, 0x131b086dL, 0xc85f8f04L, 0x8163f223L,
	0xbd77fa49L, 0xf44b876eL, 0x2f0f0007L, 0x66337d20L,
	0x9c6a7824L, 0xd5560503L, 0x0e12826aL, 0x472eff4dL,
	0xff4cfe93L, 0xb67083b4L, 0x6d3404ddL, 0x240879faL,
	0xde517cfeL, 0x976d01d9L, 0x4c2986b0L, 0x0515fb97L,
	0x2e015d56L, 0x673d2071L, 0xbc79a718L, 0xf545da3fL,
	0x0f1cdf3bL, 0x4620a21cL, 0x9d642575L, 0xd4585852L,
	0x6c3a598cL, 0x250624abL, 0xfe42a3c2L, 0xb77edee5L,
	0x4d27dbe1L, 0x041ba6c6L, 0xdf5f21afL, 0x96635c88L,
	0xaa7754e2L, 0xe34b29c5L, 0x380faeacL, 0x7133d38bL,
	0x8b6ad68fL, 0xc256aba8L, 0x19122cc1L, 0x502e51e6L,
	0xe84c5038L, 0xa1702d1fL, 0x7a34aa76L, 0x3308d751L,
	0xc951d255L, 0x806daf72L, 0x5b29281bL, 0x1215553cL,
	0x230138cfL, 0x6a3d45e8L, 0xb179c281L, 0xf845bfa6L,
	0x021cbaa2L, 0x4b20c785L, 0x906440ecL, 0xd9583dcbL,
	0x613a3c15L, 0x28064132L, 0xf342c65bL, 0xba7ebb7cL,
	0x4027be78L, 0x091bc35fL, 0xd25f4436L, 0x9b633911L,
	0xa777317bL, 0xee4b4c5cL, 0x350fcb35L, 0x7c33b612L,
	0x866ab316L, 0xcf56ce31L, 0x14124958L, 0x5d2e347fL,
	0xe54c35a1L, 0xac704886L, 0x7734cfefL, 0x3e08b2c8L,
	0xc451b7ccL, 0x8d6dcaebL, 0x56294d82L, 0x1f1530a5L
};

static u32 crc32c(u32 crc, const u8 *data, unsigned int length)
{
	int n;
	u32 *data32;

	if (length < 8)
		goto small;

	/* Take care of 4-byte unaligned data at the beginning. */
	n = 4 - (((unsigned long)data) & 3);
	if (n < 4) {
		length -= n;
		while (n--)
			crc = crc32c_table[(crc ^ *data++) & 0xff] ^ (crc >> 8);
	}

	data32 = (u32 *)data;
	while (length >= 8) {
		u32 t = *data32++ ^ crc;

		crc  = crc32c_table[(7 << 8) + ((t >>  0) & 0xff)];
		crc ^= crc32c_table[(6 << 8) + ((t >>  8) & 0xff)];
		crc ^= crc32c_table[(5 << 8) + ((t >> 16) & 0xff)];
		crc ^= crc32c_table[(4 << 8) + ((t >> 24) & 0xff)];
		t = *data32++;
		crc ^= crc32c_table[(3 << 8) + ((t >>  0) & 0xff)];
		crc ^= crc32c_table[(2 << 8) + ((t >>  8) & 0xff)];
		crc ^= crc32c_table[(1 << 8) + ((t >> 16) & 0xff)];
		crc ^= crc32c_table[(0 << 8) + ((t >> 24) & 0xff)];
		length -= 8;
	}

	/* Remaining stuff up to 7 bytes. */
	data = (u8 *)data32;
small:
	while (length-- > 0)
		crc = crc32c_table[(crc ^ *data++) & 0xff] ^ (crc >> 8);

	return crc;
}


static int chksum_init(struct shash_desc *desc)
{
	struct chksum_ctx *mctx = crypto_shash_ctx(desc->tfm);
	struct chksum_desc_ctx *ctx = shash_desc_ctx(desc);

	ctx->crc = mctx->key;

	return 0;
}

/*
 * Setting the seed allows arbitrary accumulators and flexible XOR policy
 * If your algorithm starts with ~0, then XOR with ~0 before you set
 * the seed.
 */
static int chksum_setkey(struct crypto_shash *tfm, const u8 *key,
			 unsigned int keylen)
{
	struct chksum_ctx *mctx = crypto_shash_ctx(tfm);

	if (keylen != sizeof(mctx->key)) {
		crypto_shash_set_flags(tfm, CRYPTO_TFM_RES_BAD_KEY_LEN);
		return -EINVAL;
	}
	mctx->key = le32_to_cpu(*(__le32 *)key);
	return 0;
}

static int chksum_update(struct shash_desc *desc, const u8 *data,
			 unsigned int length)
{
	struct chksum_desc_ctx *ctx = shash_desc_ctx(desc);

	ctx->crc = crc32c(ctx->crc, data, length);
	return 0;
}

static int chksum_final(struct shash_desc *desc, u8 *out)
{
	struct chksum_desc_ctx *ctx = shash_desc_ctx(desc);

	*(__le32 *)out = ~cpu_to_le32p(&ctx->crc);
	return 0;
}

static int __chksum_finup(u32 *crcp, const u8 *data, unsigned int len, u8 *out)
{
	*(__le32 *)out = ~cpu_to_le32(crc32c(*crcp, data, len));
	return 0;
}

static int chksum_finup(struct shash_desc *desc, const u8 *data,
			unsigned int len, u8 *out)
{
	struct chksum_desc_ctx *ctx = shash_desc_ctx(desc);

	return __chksum_finup(&ctx->crc, data, len, out);
}

static int chksum_digest(struct shash_desc *desc, const u8 *data,
			 unsigned int length, u8 *out)
{
	struct chksum_ctx *mctx = crypto_shash_ctx(desc->tfm);

	return __chksum_finup(&mctx->key, data, length, out);
}

static int crc32c_cra_init(struct crypto_tfm *tfm)
{
	struct chksum_ctx *mctx = crypto_tfm_ctx(tfm);

	mctx->key = ~0;
	return 0;
}

static struct shash_alg alg = {
	.digestsize		=	CHKSUM_DIGEST_SIZE,
	.setkey			=	chksum_setkey,
	.init   		= 	chksum_init,
	.update 		=	chksum_update,
	.final  		=	chksum_final,
	.finup  		=	chksum_finup,
	.digest  		=	chksum_digest,
	.crc32c  		=	crc32c,
	.descsize		=	sizeof(struct chksum_desc_ctx),
	.base			=	{
		.cra_name		=	"crc32c",
		.cra_driver_name	=	"crc32c-generic",
		.cra_priority		=	100,
		.cra_blocksize		=	CHKSUM_BLOCK_SIZE,
		.cra_ctxsize		=	sizeof(struct chksum_ctx),
		.cra_module		=	THIS_MODULE,
		.cra_init		=	crc32c_cra_init,
	}
};

static int __init crc32c_mod_init(void)
{
	return crypto_register_shash(&alg);
}

static void __exit crc32c_mod_fini(void)
{
	crypto_unregister_shash(&alg);
}

module_init(crc32c_mod_init);
module_exit(crc32c_mod_fini);

MODULE_AUTHOR("Clay Haapala <chaapala@cisco.com>");
MODULE_AUTHOR("Hiro Sugawara <hiro.sugawara@netgear.com>");
MODULE_DESCRIPTION("CRC32c (Castagnoli) calculations wrapper for lib/crc32c");
MODULE_LICENSE("GPL");
