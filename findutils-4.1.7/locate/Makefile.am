# The default database to build and search.
AUTOMAKE_OPTIONS = ../lib/ansi2knr
LOCATE_DB = $(localstatedir)/locatedb
localedir = $(datadir)/locale

bin_PROGRAMS = locate
libexec_PROGRAMS = frcode code bigram
bin_SCRIPTS = updatedb
man_MANS = locate.1 updatedb.1 locatedb.5

EXTRA_DIST = locatedb.h updatedb.sh $(man_MANS)
CLEANFILES = updatedb

INCLUDES = -I$(top_srcdir)/lib -I../intl -DLOCATE_DB=\"$(LOCATE_DB)\" -DLOCALEDIR=\"$(localedir)\"

LDADD = ../find/version.o ../lib/libfind.a @INTLLIBS@

$(PROGRAMS) $(LIBPROGRAMS): ../find/version.o ../lib/libfind.a

updatedb: updatedb.sh
	rm -f $@
	find=`echo find|sed '$(transform)'`; \
	frcode=`echo frcode|sed '$(transform)'`; \
	bigram=`echo bigram|sed '$(transform)'`; \
	code=`echo code|sed '$(transform)'`; \
	sed \
	-e "s,@""bindir""@,$(bindir)," \
	-e "s,@""libexecdir""@,$(libexecdir)," \
	-e "s,@""LOCATE_DB""@,$(LOCATE_DB)," \
	-e "s,@""VERSION""@,@VERSION@," \
	-e "s,@""find""@,$${find}," \
	-e "s,@""frcode""@,$${frcode}," \
	-e "s,@""bigram""@,$${bigram}," \
	-e "s,@""code""@,$${code}," \
	$(srcdir)/updatedb.sh > $@
	chmod +x $@

install:
	$(top_srcdir)/mkinstalldirs $(localstatedir)

SUBDIRS = testsuite
