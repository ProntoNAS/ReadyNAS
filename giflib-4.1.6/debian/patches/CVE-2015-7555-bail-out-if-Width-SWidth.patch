From: "Eric S. Raymond" <esr@thyrsus.com>
Date: Tue, 5 Jan 2016 23:01:45 -0500
Subject: CVE-2015-7555: bail out if Width > SWidth

Cherry-picked upstream commit 179510be300bf11115e37528d79619b53c884a63
---
 util/giffix.c | 2 ++
 1 file changed, 2 insertions(+)

diff --git a/util/giffix.c b/util/giffix.c
index 247305e..408d429 100644
--- a/util/giffix.c
+++ b/util/giffix.c
@@ -137,6 +137,8 @@ int main(int argc, char **argv)
 		Height = GifFileIn->Image.Height;
 		GifQprintf("\n%s: Image %d at (%d, %d) [%dx%d]:     ",
 		    PROGRAM_NAME, ++ImageNum, Col, Row, Width, Height);
+		if (Width > GifFileIn->SWidth)
+		    GIF_EXIT("Image is wider than total");
 
 		/* Put the image descriptor to out file: */
 		if (EGifPutImageDesc(GifFileOut, Col, Row, Width, Height,
