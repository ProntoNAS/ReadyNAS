https://github.com/dosfstools/dosfstools/commit/07908124838afcc99c577d1d3e84cef2dbd39cb7

--- dosfstools-3.0.13.orig/src/fat.c
+++ dosfstools-3.0.13/src/fat.c
@@ -196,10 +196,12 @@ void set_fat(DOS_FS * fs, unsigned long
 	    data[1] = new >> 4;
 	} else {
 	    FAT_ENTRY subseqEntry;
-	    get_fat(&subseqEntry, fs->fat, cluster + 1, fs);
+	    if (cluster != fs->clusters - 1)
+	        get_fat(&subseqEntry, fs->fat, cluster + 1, fs);
+	    else
+	        subseqEntry.value = 0;
 	    data[0] = new & 0xff;
-	    data[1] = (new >> 8) | (cluster == fs->clusters - 1 ? 0 :
-				    (0xff & subseqEntry.value) << 4);
+	    data[1] = (new >> 8) | ((0xff & subseqEntry.value) << 4);
 	}
 	size = 2;
 	break;
