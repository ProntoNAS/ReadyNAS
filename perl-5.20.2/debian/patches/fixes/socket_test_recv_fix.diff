From 1e958255b51b4893793c238d256c27709c23a3fe Mon Sep 17 00:00:00 2001
From: Leon Timmermans <fawaka@gmail.com>
Date: Wed, 24 Sep 2014 23:17:21 +0200
Subject: Compare recv return value to peername in socket test

Bug: https://rt.perl.org/Public/Bug/Display.html?id=122657
Bug-Debian: https://bugs.debian.org/758718
Patch-Name: fixes/socket_test_recv_fix.diff
---
 t/io/socket.t | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

diff --git a/t/io/socket.t b/t/io/socket.t
index b723e3c6e..345d196b9 100644
--- a/t/io/socket.t
+++ b/t/io/socket.t
@@ -102,7 +102,7 @@ SKIP: {
 	    my $buf;
 	    my $recv_peer = recv($child, $buf, 1000, 0);
 	    # [perl #118843]
-	    ok_child($recv_peer eq '' || $recv_peer eq $bind_name,
+	    ok_child($recv_peer eq '' || $recv_peer eq getpeername $child,
 	       "peer from recv() should be empty or the remote name");
 	    while(defined recv($child, my $tmp, 1000, 0)) {
 		last if length $tmp == 0;
