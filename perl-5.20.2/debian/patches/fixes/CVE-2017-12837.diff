From 7e83d8d978068ef77982ceecb5af58704aaffda4 Mon Sep 17 00:00:00 2001
From: Karl Williamson <khw@cpan.org>
Date: Wed, 21 Jun 2017 11:33:37 -0600
Subject: regcomp [perl #131582]

Origin: backport, https://perl5.git.perl.org/perl.git/commit/96c83ed78aeea1a0496dd2b2d935869a822dc8a5
Bug: https://rt.perl.org/Public/Bug/Display.html?id=131582
Bug-Debian: https://bugs.debian.org/875596
Patch-Name: fixes/CVE-2017-12837.diff
---
 regcomp.c | 1 +
 1 file changed, 1 insertion(+)

diff --git a/regcomp.c b/regcomp.c
index 606b3373b..ddb5d12d5 100644
--- a/regcomp.c
+++ b/regcomp.c
@@ -11792,6 +11792,7 @@ tryagain:
                             goto loopdone;
                         }
                         p = RExC_parse;
+                        RExC_parse = parse_start;
                         if (ender > 0xff) {
                             REQUIRE_UTF8;
                         }
