***************
*** 222,231 ****
  		    &amp;&amp; (pm-&gt;msg[9] != ' ' || pm-&gt;msg[10] != '\0')))
  		    p = pm-&gt;msg;
  		/* Read the password. */
- 		pr-&gt;resp = estrdup((char *) tgetpass(p,
- 		    def_ival(I_PASSWD_TIMEOUT) * 60, tgetpass_flags));
- 		if (pr-&gt;resp == NULL)
- 		    pr-&gt;resp = strdup(&quot;&quot;);
  		if (*pr-&gt;resp == '\0')
  		    nil_pw = 1;		/* empty password */
  		else
--- 222,230 ----
  		    &amp;&amp; (pm-&gt;msg[9] != ' ' || pm-&gt;msg[10] != '\0')))
  		    p = pm-&gt;msg;
  		/* Read the password. */
+ 		pass = tgetpass(p, def_ival(I_PASSWD_TIMEOUT) * 60,
+ 		    tgetpass_flags);
+ 		pr-&gt;resp = estrdup(pass ? pass : &quot;&quot;);
  		if (*pr-&gt;resp == '\0')
  		    nil_pw = 1;		/* empty password */
  		else
