Index: pkg-net-snmp/agent/mibgroup/agentx/master.c
===================================================================
--- pkg-net-snmp.orig/agent/mibgroup/agentx/master.c	2014-09-21 19:07:43.820073097 +0900
+++ pkg-net-snmp/agent/mibgroup/agentx/master.c	2014-09-21 19:27:42.611687481 +0900
@@ -236,6 +236,9 @@
     if (!cache) {
         DEBUGMSGTL(("agentx/master", "response too late on session %08p\n",
                     session));
+        /* response is too late, free the cache */
+        if (magic)
+            netsnmp_free_delegated_cache((netsnmp_delegated_cache*) magic);
         return 0;
     }
     requests = cache->requests;
@@ -621,6 +624,8 @@
 
     if (result == 0 ) {
         snmp_free_pdu( pdu );
+        if (cb_data)
+            netsnmp_free_delegated_cache((netsnmp_delegated_cache*) cb_data);
     }
 
     return SNMP_ERR_NOERROR;
Index: pkg-net-snmp/agent/mibgroup/agentx/master_admin.c
===================================================================
--- pkg-net-snmp.orig/agent/mibgroup/agentx/master_admin.c	2014-09-21 19:07:43.820073097 +0900
+++ pkg-net-snmp/agent/mibgroup/agentx/master_admin.c	2014-09-21 19:11:08.660690270 +0900
@@ -139,11 +139,16 @@
          * requests, so that the delegated request will be completed and
          * further requests can be processed
          */
-        netsnmp_remove_delegated_requests_for_session(session);
+	while (netsnmp_remove_delegated_requests_for_session(session)) {
+		DEBUGMSGTL(("agentx/master", "Continue removing delegated reqests\n"));
+	}
+
         if (session->subsession != NULL) {
             netsnmp_session *subsession = session->subsession;
             for(; subsession; subsession = subsession->next) {
-                netsnmp_remove_delegated_requests_for_session(subsession);
+                while (netsnmp_remove_delegated_requests_for_session(subsession)) {
+			DEBUGMSGTL(("agentx/master", "Continue removing delegated subsession reqests\n"));
+		}
             }
         }
                 
