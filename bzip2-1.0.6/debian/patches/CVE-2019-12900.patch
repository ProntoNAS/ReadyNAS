Description: CVE-2019-12900
  nSelectors is used in a loop from 0 to nSelectors to access selectorMtf
  which is
	UChar    selectorMtf[BZ_MAX_SELECTORS];
 so if nSelectors is bigger than BZ_MAX_SELECTORS it'll do an invalid memory
 access
 Fixes out of bounds access discovered while fuzzying karchive
Index: bzip2-1.0.6/decompress.c
===================================================================
--- bzip2-1.0.6.orig/decompress.c	2010-09-11 00:43:17.000000000 +0200
+++ bzip2-1.0.6/decompress.c	2019-06-21 23:29:18.133055769 +0200
@@ -287,7 +287,7 @@
       GET_BITS(BZ_X_SELECTOR_1, nGroups, 3);
       if (nGroups < 2 || nGroups > 6) RETURN(BZ_DATA_ERROR);
       GET_BITS(BZ_X_SELECTOR_2, nSelectors, 15);
-      if (nSelectors < 1) RETURN(BZ_DATA_ERROR);
+      if (nSelectors < 1 || nSelectors > BZ_MAX_SELECTORS) RETURN(BZ_DATA_ERROR);
       for (i = 0; i < nSelectors; i++) {
          j = 0;
          while (True) {
