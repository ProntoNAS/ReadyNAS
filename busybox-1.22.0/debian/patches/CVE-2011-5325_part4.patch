From: Markus Koschany <apo@debian.org>
Date: Fri, 3 Aug 2018 05:37:59 +0200
Subject: CVE-2011-5325_part4

It was found that the patch to prevent the exploitation of CVE-2011-5325 is too
strict in case of cpio archives. This commit restores the old behavior.

Origin: https://git.busybox.net/busybox/commit/archival/cpio.c?id=d9503224c8a93a30b0c8627084b2744d3ee6f403
---
 archival/cpio.c | 2 ++
 1 file changed, 2 insertions(+)

diff --git a/archival/cpio.c b/archival/cpio.c
index 1cce7c8..9c46da3 100644
--- a/archival/cpio.c
+++ b/archival/cpio.c
@@ -480,6 +480,8 @@ int cpio_main(int argc UNUSED_PARAM, char **argv)
 	while (get_header_cpio(archive_handle) == EXIT_SUCCESS)
 		continue;
 
+	create_symlinks_from_list(archive_handle->symlink_placeholders);
+
 	if (archive_handle->cpio__blocks != (off_t)-1
 	 && !(opt & OPT_QUIET)
 	) {
