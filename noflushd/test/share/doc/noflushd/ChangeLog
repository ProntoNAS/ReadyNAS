noflushd - ChangeLog

* version 2.7.5 (20050509) [dk]

  - Do not fail with raid and similar meta devices on 2.6 kernels.
    (Thomas Liske)
  - Be more silent on startup when monitorring interrupts.

* version 2.7.4 (20040808) [dk]

  - Document undesirable side-effects with hotplugged drives, and
    recommend to restart noflushd from the hotplug daemon.
  - Add fflush() after having updated the flush interval on 2.6
    kernels to make sure the new value propagates to the kernel in time.
    (Ruediger Greeb)
  - Fix 2.6 diskstat parser to work with SCSI disks. (Holger Hofstaette)
  - Fix return from pipe in generic startup script. (Markus Biermaier)

* version 2.7.3 (20040408) [dk]

  - Fix race condition in kupdated/pdflush handling: the TERM handler
    might call the start routine with zero timeout.
  - Make sure disk_info names always contain the full path to the
    device node. Fixes spindown when all disks are auto-detected.

* version 2.7.2 (20040316) [dk]

  - Only sync disks, but do not flush the cache on spindown.

* version 2.7.1 (20040307) [dk]

  - Minor fixes to generic init script.
  - Include scsi-idle patch for kernel version 2.4.23.
  - Update documentation on scsi-idle.
  - SCSI support is now a command line option.
  - Plug memleak in pdflush interaction.
  - Various bug fixes in diskstat parser for 2.6 kernels.
  - Make sure IDE sync is finished before attempting spindown.
  - Ensure pdflush timers have expired before acknowledging stop.
  - Catch bogus pdflush intervals and override with default.
  - Add and document inode tracing patch.
  - Initialize /proc/partitions parser before daemonizing.

* version 2.7 (20040120) [dk]

  - Support the Linux 2.6 kernel series. (Michael Buesch)
  - Change default behaviour to auto-probe and monitor all disks
    unless the user explicitly specifies a particular set of disks
    on the command line.
  - Sync disks twice before spindown to work around apparent async
    behaviour of fsync().
  - Disks are synced right after spinup.
  - kupdated interface no longer uses the obsolete bdflush() syscall.
  - When spindown is cancelled, the idle timer is reset. (Mukesh Rajan)

* version 2.6.3 (20020513) [dk]

  - Layout of /proc/interrupts differs across archs.  Fix parser.

* version 2.6.2 (20020420) [dk]

  - Tell partition parser about IDE raid controllers.
  - Include timeout logging scripts in contrib. (Thomas Link)
  - Minor documentation update.

* version 2.6.1 (20020203) [dk]

  - Fix stat handling for disks on second IDE channel.

* version 2.6 (20020122) [dk]

  - Honour disk_index() change in recent (ac) kernels.
  - No longer depend on kernel includes (major.h).
  - Add irq monitoring. Can be used to prevent spindown when machine is
    in interactive use. (Laurent Pelecq)
  - sync(2) apparently isn't fully synchronous. A subtle sleep() helps
    prevent some immediate spinups right after spindown.
  - More clueful error message if kernel does not provide any useful disk
    statistics.
  - General documentation overhaul. Most importantly, document that
    noflushd really sucks with _any_ journaling fs right now, including
    ext3.

* version 2.5 (20010806) [dk]

  - Teach generic startup skript about kupdate->kupdated
    as well.
  - Monitor /proc/partitions for run-time added disks.
  - Only sync present partitions.
  - Check manual interaction before spindown.
  - Parsing cleanup in update_io_new. (Pavel Machek)
  - Fixed get_line() bug that sometimes triggered a segfault.
  - Follow POSIX and no longer ignore SIG_CHLD.
  - Split documentation into several files.
  
* version 2.4 (20010313) [dk]

  - Fixed handling of timeout lists. (Olivier Chapuis)
  - Corrected installation location of init skript.
  - Re-introduce verbose spindown messages. (Bob Mathews)
  - Honour name change kupdate->kupdated in kernel versions
    2.4.2-ac15 and 2.4.3pre3.

* version 2.3 (20010120) [dk]

  - Fixed /proc/stat parser for latest format change in 2.4.0-test9.
    Leaves noflushd non-working on 2.3.99pre8 to 2.4.0-test8.
  - Improved early-stage debugging.
  - Fix polling intervals in partial state and long bdflush timeouts.
    (Adapted from patch by Brent Roman)
  - Hint users to not point noflushd to partitions but to device nodes
    of the whole disk.

* version 2.2 (20001222) [dk]

  - Fixed stupid error in try_spindown() preventing spindown. Kudos to
    Bob Mathews for tracking down the bug.

* version 2.1 (20001220) [dk]

  - Included automake-generated files in build tree - dpkg-source includes
    symlinks otherwise.
  - Sync disks prior to spindown.
  - Saner logic to detemine directory of device nodes. 

* version 2.0 (20001114) [dk]

  - Major code reorganisation, considerable rewrite of most parts.
  - Turn off kupdate temporarily before checking i/o stats.
  - Switched to automake/autoconf build.
  - Improved multidisk handling via own syncer. (Patch by Pavel Machek)
  - Cured alpha segfault due to wrong cast. (Patch by Andrew Lenharth)
  - Init skript missed the noflushd move to /usr/sbin/. (Patch by Honza Fikar)

* version 1.8.5 (20000807) [dk]

  - Newstyle stat support left oldstyle buggy. (Patch by Andreas U. Trottmann)

* version 1.8.4 (20000803) [dk]

  - noflushd won't get confused by raid and LVM entries any longer.
  - Made pidfile handling optional.
  - Included policy changes from debian maintainer.
  - Added libc5 compatibility.
  - Added support for /proc/stat format in 2.3.99pre8+.
  - Added devfs kludges.
  - Fixed devfs hang.
  - Added spindown ioctl for really old hds.
  - Updated documentation.

* version 1.8.3 (20000313) [dk]

  - Added IDE CD-ROM auto-detection
  - Added timeout lists
  - Added pidfile handling (might better be done in init skript)
  - Added proper GPL blurb
  - Updated documentation

* version 1.8.2 (20000207) [dk]

  - Oops. Forgot to decrement rw_spinning if mark read-only requested

* version 1.8.1 (20000127) [dk]

  - Added mark-readonly option
  - Fixed /proc/partition parsing - won't skip last entry any longer
  - Fixed last minute read accounting bug

* version 1.8 (20000125) [dk]

  - Added multiple disk support
  - Added basic SCSI support (still needs kernel patch)
  - Moved spindown and kupdate handling from helper skripts into daemon
  - Changed commandline options (sorry, but let's do this once and for all)
  - Removed helper skripts
  - Updated documentation

* version 1.7.4 (19990904) [dk]

  - changed spindown-now signal from SIGHUP to SIGUSR1
  - helper skripts get called with device argument
  - various code cleanups
  - documentation update
  - merged RedHat and SuSE RPM specs

* version 1.7.3 (19990827) [dk]

  - fixed stupid bug in /proc/stat parsing
  - added Makefile rule to build debian source and binary package
  - added directory contrib with preliminary scsi support that's of
    absolutely no use at the moment

* version 1.7.2 (19990826) [dk]

  - fixed a bug that would leave kupdate stopped if disk was spun up
    due to an explicit write request via sync
  - added framework to generate rpm and deb archives
  - restructured Makefile; 'make install' now tries to guess 
    distribution and SysV init layout
  - added support for rc.config (START_NOFLUSHD and NOFLUSHD_TIMEOUT)
  - fixed a few typos

* version 1.7.1 (19990824) [dk]

  - added SIGTERM handler to call spinup helper before quitting; avoids
    leaving kupdate stopped
  - moved spinup/spindown skripts from RCDIR to BINDIR
  - renamed install spinup/spindown skripts to noflushd-spinup/spindown
  - added make targets for easy installation on Debian, RedHat and SuSE
    systems
  - tried to make helper skripts work on Debian, RedHat and SuSE systems

* version 1.7 (19990821) [dk]

  - initial release (taken out from the bdflush-1.6.2 sources, hence the
    strange version number)

      
